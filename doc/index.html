<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="main.css">
    <title>Veebipoe infosüsteem</title>
</head>

<body>
<div id="wrapper">
    <h1>SISUKORD</h1>
    <ol>
        <li><span><b>1. STRATEEGIA ETAPP</b></span></li>
        <li><span>1.1 Terviksüsteemi üldvaade</span></li>
        <ol>
            <li>&nbsp;1.1.1 Organisatsiooni eesmärgid<br>
                &nbsp;1.1.2 Infosüsteemi eesmärgid<br>
                &nbsp;1.1.3 Lausendid<br>
                &nbsp;1.1.4 Põhiobjektid<br>
                &nbsp;1.1.5 Põhiprotsessid<br>
                &nbsp;1.1.6 Põhilised sündmused<br>
                &nbsp;1.1.7 Tegutsejad<br>
                &nbsp;1.1.8 Asukohad<br>
                &nbsp;1.1.9 Terviksüsteemi tükeldus allsüsteemideks<br>
                &nbsp;&nbsp;1.1.9.1 Pädevusalad<br>
                &nbsp;&nbsp;1.1.9.2 Funktsionaalsed allsüsteemid<br>
                &nbsp;&nbsp;1.1.9.3 Registrid
            <li>
        </ol>
        <br>
        <li><span>1.2 Kaupade arvestuse funktsionaalne allsüsteem</span></li>
        <ol>
            <li>&nbsp;1.2.1 Eesmärgid<br>
                &nbsp;1.2.2 Allsüsteemi kasutatavad pädevusalad<br>
                &nbsp;1.2.3 Allsüsteemi poolt kasutatavad registrid<br>
                &nbsp;1.2.4 Allsüsteemi ühe põhiprotsessi tegevusdiagramm<br>
                &nbsp;1.2.5 Allsüsteemi kasutusjuhtude eskiismudel<br>
                &nbsp;1.2.6 Mittefunktsionaalsed nõuded
            </li>
        </ol>
        <br>
        <li><span>1.3 Kaupade register</span></li>
        <li>&nbsp;1.3.1 Eesmärgid<br>
            &nbsp;1.3.2 Registrit kasutavad pädevusalad<br>
            &nbsp;1.3.3 Registrit teenindavad funktsionaalsed allsüsteemid<br>
            &nbsp;1.3.4 Infovajadused, mida register aitab rahuldada<br>
            &nbsp;1.3.5 Seosed teiste registritega<br>
            &nbsp;1.3.6 Ärireeglid<br>
            &nbsp;1.3.7 Registri kontseptuaalne eskiismudel
        </li>
    </ol>
    <br>
    <ol>
        <li><span><b>2 DETAILANALÜÜSI ETAPP</b></span></li>
        <br>
        <li><span>2.1 Kaupade arvestuse funktsionaalne allsüsteem</span>
            <ol>
                <li>
                    &nbsp;2.1.1 Kasutusjuhtude mudel
                </li>
            </ol>
            <br>
        <li><span>2.2 Kaupade register (laiendatud kuju)</span></li>
        <ol>
            <li>&nbsp;2.2.1 Kontseptuaalne andmemudel<br>
                &nbsp;&nbsp;2.2.1.1 Olemi-suhte diagramm<br>
                &nbsp;&nbsp;2.2.1.2 Olemitüüpide definitsioonid<br>
                &nbsp;&nbsp;2.2.1.3 Atribuutide definitsioonid<br>
            </li>
        </ol>
        <ol>
            <li>
                &nbsp;2.2.2 Andmebaasioperatsioonide lepingud<br>
                &nbsp;2.2.3 Registri põhiobjekti seisundidiagramm<br>
            </li>
        </ol>
        <br>
        <li><span>2.3 CRUD-maatriks</span>
        <li><span><br>2.4 Infosüsteemi rollide kirjeldused</span>
    </ol>
    <ol>
        <li><span><br><b>3. FÜÜSILINE DISAIN</b></span></li>
        <li><span>3.1 Laiendatud kaupade registri füüsiline disain</span>
            <ol>
                <li>&nbsp;3.1.1 Füüsiline andmebaasiskeem<br>
                </li>
            </ol>
    </ol>
    <ol>
        <li><span><br><b>4 REALISATSIOON POSTGRESQLIS</b></span></li>
        <br>
        <li><span>4.1 Andmebaasi loomine</span></li>
        <li><span>4.2 Skeemid</span></li>
        <li><span>4.3 Domeenid</span></li>
        <li><span>4.4 Tabelid ja arvujada generaatorid</span></li>
        <li><span>4.5 Vaated</span></li>
        <li><span>4.6 Protseduursed keeled</span></li>
        <li><span>4.7 Trigeri funktsioonid ja trigerid</span></li>
        <li><span>4.8 Reeglid</span></li>
        <li><span>4.9 Funktsioonid</span></li>
        <li><span>4.10 Indeksid</span></li>
        <ol>
            &nbsp;4.10.1 Välisvõtmetele lisatavad indeksid <br>
            &nbsp;4.10.2 Täiendavad sekundaarsed indeksid<br>
            &nbsp;4.10.3 Funktsioonil põhinevad indeksid<br>
        </ol>
        <li><span>4.11 Klassifikaatorite väärtustamine SQL laused</span></li>
        <li><span>4.12 Täiendavate testandmete lisamine</span></li>
        <li><span>4.13 Andmebaasi statistika kogumine</span></li>
        <li><span>4.14 Päringu täitmisplaani näide</span></li>
        <li><span>4.15 Rollid ja kasutajad</span></li>
        <li><span>4.16 Õiguste jagamine</span></li>
        <li><span>4.17 Andmebaasiobjektide kustutamine</span></li>
        <ol>
            &nbsp;4.17.1 Domeenide kustutamine<br>
            &nbsp;4.17.2 Tabelite kustutamine<br>
            &nbsp;4.17.3 Arvujada generaatorite kustutamine<br>
            &nbsp;4.17.4 Vaadete kustutamine <br>
            &nbsp;4.17.5 Indeksite kustutamine<br>
            &nbsp;4.17.6 Funktsioonide ja trigerite kustutamine<br>
            &nbsp;4.17.7 Reeglite kustutamine<br>
            &nbsp;4.17.8 Kasutajate ja rollide kustutamine<br>
        </ol>
    </ol>
    <ol>
        <li><span><br><b>5 KASUTATUD MATERJALID</b></span></li>
    </ol>
    </ol>
</div>
<div>
    <h4>AUTORIDEKLARATSIOON</h4>

    <p>
        Kinnitame, et oleme koostanud antud töö iseseisvalt ning seda ei ole kellegi teise poolt varem
        hindamiseks/arvestuse saamiseks esitatud. Kõik töö koostamisel kasutatud teiste autorite tööd, olulised
        seisukohad, kirjandusallikatest ja mujalt pärinevad andmed on töös viidatud.
    </p>

    <p>
        Mart Laus, Kaarel Kivistik, Siim-Martin Kaasik
    </p>

    <p>[Allkirjad]</p>
</div>
<h4>Sissejuhatus (Andmebaasid II)</h4>

<div>
    <table border="1" style="width:100%">
        <tr>
            <td>Kasutatav andmebaasisüsteem ja versioon</td>
            <td>PostgreSQL 9.4</td>
        </tr>
        <tr>
            <td>Rakenduse loomise vahendid (arenduskeskkonnad, keeled ja nende versioonid)</td>
            <td>MS Access 2013</td>
        </tr>
        <tr>
            <td>Andmebaasi server</td>
            <td>apex.ttu.ee</td>
        </tr>
        <tr>
            <td>PostgreSQL andmebaasi nimi</td>
            <td>t123665</td>
        </tr>
        <tr>
            <td>Millise töökoha rakendus realiseerib?</td>
            <td>Kaupade haldur</td>
        </tr>
        <tr>
            <td>Kui tegemist on kahekihilise klient-server süsteemiga ja rakendus on kasutaja arvutis, siis mida peab
                kasutaja arvutis tegema, et seda rakendust kasutada
            </td>
            <td>Rakenduse toimimiseks peab kasutaja arvutis olema installeeritud PostgreSQL ODBC draiverid ja loodud
                andmeühenduse spetsifikatsioon (data source) nimega PostgreSQL_yhendus. Andmeühenduse spetsifikatsioonis
                peavad server, andmebaas, kasutajanimi ja parool olema määramata.
            </td>
        </tr>
        <tr>
            <td>Kasutajanimi ja parool rakendusse sisselogimiseks</td>
            <td>kasutajanimi: hans@mets.ee <br>
                parool: parool1 <br>
                kasutajanimi: jaan@koer.ee <br>
                parool: parool2
            </td>
        </tr>
        <tr>
            <td>Millistes vormides (MS Accessi korral), lehekülgedel (Oracle APEX korral), failides (mingis
                programmeerimiskeeles loodud rakenduse puhul) toimub pöördumine andmebaasiserveris talletatud rutiinide
                poole?
            </td>
            <td>Ekraanivormil Sissereg pöördutakse nupule
                Jätka vajutamise järel kasutaja-defineeritud
                funktsiooni f_on_kaupade_haldur poole. Funktsioon
                on mõeldud töötaja identifitseerimiseks.<br>
                Ekraanivormil Kauba_info_muutmine pöördutakse nupule Salvesta vajutamise järel kasutaja-defineeritud
                funktsiooni f_uuenda_kaupa poole, nupule Kustuta vajutamise järel kasutaja-defineeritud funktsiooni f_kustuta_kaup poole.
            </td>
        </tr>

        <tr>
            <td>Millistes vormides (MS Accessi korral), lehekülgedel (Oracle APEX korral), failides (mingis
                programmeerimiskeeles loodud rakenduse puhul) toimub pöördumine andmebaasis loodud vaadete poole? Faili
                puhul palun näidata ka kataloog.
            </td>
            <td>
                Ekraanivormil Kaupade_haldamine olevad andmed leitakse vaatest kauba_kuvatav_info.<br/>
                Tootja liitboksi leitakse andmed vaatest tootja.<br/>
                Tarnia liitboksi leitakse andmed tarnija.<br/>
                Töötaja liitboksi leitakse andmed aktiivne_tootaja.<br/>
            </td>
        </tr>
        <tr>
            <td>Kuhu (millisesse moodulisse, faili) on rakenduses kirjutatud andmebaasisüsteemiga ühenduse loomiseks
                mõeldud andmebaasi kasutaja nimi (see peab olema minimaalsete vajalike õigustega kasutaja)? Faili puhul
                palun näidata ka kataloog.
            </td>
            <td>
                Andmebaasisüsteemiga ühenduse loomiseks
                kasutatav kasutajanimi (garaazh_rakendus)
                on kirjutatud mooduli Refreshing algusesse
                (konstandi username väärtuseks).
            </td>
        </tr>
        <tr>
            <td>Kas rakendus suhtleb andmebaasisüsteemiga kui üks kasutaja või vastab igale lõppkasutajale eraldi
                andmebaasi kasutaja?
            </td>
            <td>
                Rakendus suhtleb andmebaasiga kui üks kasutaja
            </td>
        </tr>
        <tr>
            <td>
                Kas lõppkasutajate kasutajanimed ja paroolid on andmebaasis (kui jah, siis mis tabeli mis veergudes)?
            </td>
            <td>
                Jah (tabeli tootaja veerud e_mail ja parool)
            </td>
        </tr>
        <tr>
            <td>
                Kuidas on andmebaasis salvestatud parool kaitstud?
            </td>
            <td>
                Andmebaasis hoitakse parooli räsiväärtust.
                See väärtus leitakse andmebaasisüsteemi
                poolt kasutades sisendina avatekstina parooli
                ning süsteemi-genereeritud soola.
                Parooli räsiväärtuse leidmiseks kasutatakse
                PostgreSQL funktsiooni crypt koos soola
                genereerimiseks mõeldud funktsiooniga
                gen_salt. Räsiväärtuse leidmiseks kasutatakse
                Blowfish plokkšifril (krüptograafilisel algoritmil)
                põhinevat algoritmi, mille puhul võib parooli
                pikkus olla kuni 72 märki. Seda algoritmi
                eelistati, kuna Cybernetica AS (2013) hindab
                selle viie aasta jooksul turvaliseks primitiiviks
                (erinevalt algoritmidest DES ja MD5, mida
                crypt samuti toetab).
                Veerus parool lubatud maksimaalne väärtuse
                suurus peab valitud algoritmi korral olema 60
                märki (veerg on tüüpi VARCHAR(60)).
                gen_salt funktsioon võimaldab lisaks
                algoritmile määrata ka algoritmi kasutatavat
                korduste arvu (kui algoritm seda võimaldab).
                Mida suurem korduste arv, seda rohkem võtab
                aega räsiväärtuse arvutamine, aga ka selle
                murdmine. Blowfish algoritmi korral on
                vaikimisi korduste arv 6, kuid võimalik korduste
                arvu vahemik on 4 kuni 31. Määran korduste
                arvuks 11, mille puhul räsiväärtuse leidmisel ja
                kontrollimisel veel olulist töökiiruse langust ei
                täheldatud.
                Funktsiooni crypt kasutamiseks on
                PostgreSQL andmebaasis CREATE
                EXTENSION lauset kasutades installeeritud
                lisamoodul pgcrypto. Installeerimise tulemusel
                loodavad skeemiobjektid paigutatakse skeemi
                public.
                CREATE EXTENSION IF NOT EXISTS
                pgcrypto WITH SCHEMA public;
            </td>
        </tr>
        <tr>
            <td>
                Kuidas toimub kasutaja autentimine?
            </td>
            <td>
                Kontrollimaks kasutaja identiteeti võrreldakse
                kasutaja etteantud parooli põhjal genereeritud
                räsiväärtust andmebaasis salvestatud parooli
                räsiväärtusega. Lisaks kontrollitakse, et
                kasutaja töötaks ametikohal, mille esindajana
                ta soovib sisse logida ning oleks seisundis, mis
                lubab süsteemi kasutada. Kui need väärtused
                on võrdsed ja nimetatud lisatingimused on
                täidetud, siis on kasutaja tuvastatud ja ta võib
                hakata süsteemi kasutama. See kontroll
                toimub serveris, et andmebaasis salvestatud
                räsiväärtus ei liiguks üle võrgu kliendi juurde.
                Antud juhul viib kontrolli läbi
                andmebaasisüsteem. Kontrollimaks, kas
                kasutaja on sobivas seisundis kaupade haldur,
                luuakse andmebaasis funktsioon
                f_on_kaupade_haldur(text, text). Funktsiooni
                väljakutsel on esimene argument e-mail
                ja teine argument parool.
            </td>
        </tr>
        <tr>
            <td>
                Kas olete oma töö iseseisva töö
                hindamismudeli alusel enne
                esitamist ise üle kontrollinud?
            </td>
            <td>
                Jah
            </td>
        </tr>

    </table>
</div>

<h1>1. Strateegia etapp</h1>

<div>
    <h2>1.1 Terviksüsteemi üldvaade</h2>

    <p>Järgnevalt esitatakse ülevaade anonüümse arvutikaupade veebipoe toimimisest. Antud ettevõttel on üks oma ladu
        ning klientide privaatsuse huvides ja turunišši täitmiseks nende infot ei salvestata.</p>

    <div>
        <h3>1.1.1 Organisatsiooni eesmärgid</h3>

        <div>
            <ul>
                <li>
                    Arvutikaupade veebipoe peamiseks eesmärgiks on teenida omanikele kasumit.
                </li>
                <li>
                    Veebipood tahab pakkuda mugavat ning kiiret teenust, et saavutada võimalikult suur kliendibaas ning
                    töötajate efektiivsus.
                </li>
                <li>
                    Organisatsiooni kasumi ning efektiivsuse suurendamiseks on arvutikaupade veebipoe eesmärgiks
                    juurutada võimalikult efektiivne ning produktiivne info- ning juhtimissüsteem.
                </li>
                <li>Arvutikaupade veebipood pakub oma klientidele <b>anonüümset</b> ostukogemust <b>mitte
                    salvestades</b> kasutajainfot, rahuldades seega tühja koha, mis selles sektoris turul
                    <valitseb class=""></valitseb>
                </li>
            </ul>
        </div>
        <h3>1.1.2 Infosüsteemi eesmärgid</h3>

        <p> Võimaldab: </p>
        <ul>
            <li>
                Tarnijaid - vaadata, lisada, muuta ja kustutada.
            </li>
            <li>
                Kaupu - vaadata, lisada, muuta ja kustutada.
            </li>
            <li>
                Töötajaid - vaadata, lisada, muuta ja kustutada.
            </li>
            <li>
                Vaadata, lisada, muuta ja kustutada laoliikumiste, kaupade ja töötajate olekuid.
            </li>
            <li>
                Vaadata, koostada ja muuta tellimusi ning laoliikumisi.
            </li>
            <li>
                Vaadata arvete ning laoliikumiste põhjal ettevõtte käivet ning rahavoogusid.
            </li>
            <li>Viia läbi inventuure.</li>
        </ul>
        <h3>1.1.3Lausendid</h3>
        <ul>
            <li>Veebipoes müüakse kaupu</li>
            <li>Veebipoel on <b>üks</b> oma ladu</li>
            <li>Uudistajad ostavad kaupu <b>anonüümselt</b></li>
            <li>Uudistaja lisab kaubad ostukorvi</li>
            <li>Ostukorv omistatakse ostmisel tellimusele</li>
            <li>Lattu tellitakse kaupu tarnijatelt</li>
            <li>Igast sisse- ja väljaminevast tellimusest salvestatakse laoliikumised</li>
            <li>Igal kaubal on tootja ja tarnija</li>
            <li>Infosüsteemis tegutsejad on uudistajad ja töötajad</li>
            <li>Igal kaubal on staatus mis väljendab tema olekut ajas</li>
            <li>Kaubad toimetavad kohale veebipoe töötajad pannes asjad pakiautomaati, seega kullerit pole</li>
            <li>Ostjale väljastatakse ostu eest arve</li>
            <li>Tellimuse ning laoliikumise staatust uuendatakse selle muutumisel</li>
            <li>Ainukesed salvestatud kasutajad, kes tegutsevad süsteemis on töötajad</li>
            <li>Uudistajad tegutsevad veebipoes nii, et nende infot ei salvestata</li>
            <li>Tellimusi on kahte tüüpi - sissetulevad kaubad tarnijatelt ning väljaminevad kaubad e-poe klientidele
            </li>
        </ul>
        <h3>1.1.4 Põhiobjektid</h3>
        <ul>
            <li>
                Kaup
            </li>
            <li>
                Tarnija
            </li>
            <li>
                Tootja
            </li>
            <li>
                Tellimus
            </li>
            <li>
                Töötaja
            </li>
            <li>
                Organisatsioon
            </li>
            <li>
                Klassifikaator
            </li>
            <li>
                Arve
            </li>
            <li>
                Laoliikumine
            </li>
            <li>
                Inventuur
            </li>
            <li>
                Arvustus
            </li>

        </ul>
        <h3>1.1.5 Põhiprotsessid</h3>
        <ul>
            <li>
                Tellimuse loomine
            </li>
            <li>
                Kauba registreerimine
            </li>
            <li>
                Ostukorvi koostamine
            </li>
            <li>
                Tellimuse väljastamine
            </li>
            <li>
                Arve väljastamine
            </li>
            <li>
                Arvustuse kirjutamine
            </li>
            <li>
                Klassifikaatori registreerimine
            </li>
        </ul>
        <h3>1.1.6 Põhilised sündmused</h3>
        <ul>
            <li>
                Uudistaja on moodustanud ostukorvi toodetega ning on suunatud internetipanka makset vormistama.
            </li>
            <li>
                Uudistaja on teostanud makse ja saab maksekinnituse tema sisestatud e-mailile.
            </li>
            <li>
                Veebipoe töötaja kinnitab tellimuse ning makse.
            </li>
            <li>
                Uudistaja kasutab otsingut enda soovitud toote leidmiseks.
            </li>
            <li>
                Kaupade haldur muudab kauba staatust vastavalt ärilistele ning logistilistele vajadustele.
            </li>
            <li>
                Uudistaja kirjutab saadud kauba kohta arvustuse.
            </li>

        </ul>
        <h3>1.1.7 Tegutsejad</h3>
        <ul>
            <li>
                Kaupade haldur
            </li>
            <li>
                Infosüsteemi administraator
            </li>
            <li>
                Raamatupidaja
            </li>
            <li>
                Omanik
            </li>
            <li>
                Uudistaja
            </li>

            <p>Kulleri pädevusala ei ole, kuna tema infosüsteemis ei tegutse. Kaupade haldurid tegelevad ka kaupade
                füüsilise liigutamisega laos.</p>

            <p>Kõik kliendid on uudistajad, kuna anonüümses veebipoes kliendiinfot ei salvestata.</p>

        </ul>
        <h3>1.1.8 Asukohad</h3>
        <li>
            Kliendil on võimalik veebipoele ligi pääseda mistahes internetiühendusega asukohast.
        </li>
        <li>
            Kliendil on võimalik veebipoodi kasutada nii arvuti, nutitelefoni kui ka tahvelarvutiga.
        </li>
        <h3>1.1.9 Terviksüsteemi tükeldus allsüsteemideks</h3>

        <div>
            <h4>1.1.9.1 Pädevusalad</h4>
            Organisatsiooni sisesed pädevusalad:
            <ul>
                <li>
                    Kaupade halduri pädevusala
                </li>
                <li>
                    Infosüsteemi administraatori pädevusala
                </li>
                <li>
                    Omaniku pädevusala
                </li>
                <li>
                    Raamatupidaja pädevusala
                </li>
            </ul>
            Organisatsiooni välised pädevusalad:
            <ul>
                <li>
                    Uudistaja pädevusala
                </li>
            </ul>
            <h4>1.1.9.2 Funktsionaalsed allsüsteemid</h4>

            <p> Sisulised allsüsteemid (seotud organisatsiooni põhitegevusega). </p>
            <ul>
                <li>
                    Arvete ja laoliikumiste haldamise funktsionaalne allsüsteem
                </li>
                <li>
                    Kaupade arvestamise funktsionaalne allsüsteem
                </li>
                <li>
                    Organistsioonide haldamise funktsionaalne allsüsteem
                </li>
                <li>
                    Tellimuste haldamise funtsionaalne allsüsteem
                </li>
                <li>
                    Inventuuri funktsionaalne allsüsteem
                </li>
                <li>
                    Arvustuste funktsionaalne allsüsteem
                </li>
            </ul>
            Administratiivsed allsüsteemid (võivad olla kasutusel paljudes erinevates organisatsioonides, mille
            tegevusalad ja eesmärgid on erinevad).
            <ul>
                <li>
                    Töötajate haldamise funktsionaalne allsüsteem
                </li>
                <li>
                    Klassifikaatorite funktsionaalne allsüsteem
                </li>
            </ul>
            <h4>1.1.9.3 Registrid</h4>

            <p>Sisulised registrid (seotud organisatsiooni põhitegevusega).</p>
            <ul>
                <li>
                    Kaupade register
                </li>
                <li>
                    Organisatsioonide register
                </li>
                <li>
                    Tellimuste register
                </li>
                <li>
                    Arvete ja laoliikumiste register
                </li>
                <li>
                    Inventuuri register
                </li>
                <li>
                    Arvustuste register
                </li>
            </ul>
            <p>Administratiivsed registrid :</p>
            <ul>
                <li>
                    Töötajate register
                </li>
                <li>
                    Klassifikaatorite register
                </li>
            </ul>
        </div>
    </div>
    <h2>1.2 Kaupade arvestuse funktsionaalne allsüsteem</h2>

    <div>
        <h3>1.2.1 Eesmärgid</h3>

        <div>
            <ul>
                <li>Võimaldab kaupu
                    <ul>
                        <li>lisada</li>
                        <li>muuta</li>
                        <li>kustutada</li>
                        <li>kategoriseerida</li>
                    </ul>
                </li>
                <li> Muuta kauba staatus vastavalt selle elutsüklile, et oleks võimalik jälgida, millises elutsükli
                    etapis iga konkreetne kaup parajasti viibib.
                </li>
            </ul>
        </div>
        <h3>1.2.2 Allsüsteemi kasutatavad pädevusalad</h3>
        <ul>
            <li>
                Omaniku pädevusala
            </li>
            <li>
                Administraatori pädevusala
            </li>
            <li>
                Uudistaja pädevusala
            </li>
            <li>
                Kaupade halduri pädevusala
            </li>
        </ul>
        <h3>1.2.3 Allsüsteemi poolt kasutatavad registrid</h3>

        <div>
            <ul>
                <li>Kaupade register</li>
                <li>Klassifikaatorite register</li>
                <li>Töötajate register</li>
                <li>Organisatsioonide register</li>
            </ul>
        </div>
        <h3>1.2.4 Allsüsteemi ühe põhiprotsessi tegevusdiagramm</h3>
        <img src="img/Kauba lisamise protsessidiagramm.png" alt="põhiprotsessi pilt">

        <h3>1.2.5 Allsüsteemi kasutusjuhtude eskiismudel</h3>
        <img src="img/Kaupade arvestuse allsusteemi kasutusjuhtude diagramm.png" alt="kasutusjuhtude pilt">

        <div>
            <p><b> Kasutusjuht:</b>Töötaja tuvastamine (süsteemiülene)</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b> Subjekt identifitseerib ennast. Selleks sisestab ta Töötajanime, parooli
                    ja oma rolli süsteemis. Süsteem autendib subjekti, st. kontrollib subjekti väidetavat
                    identiteeti. Kui subjekt on identifitseeritud, siis lubatakse subjekt süsteemi
                    siseneda, vastasel juhul mitte. </p>

            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba lisamine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b> Antud allsüsteemis töötav tegutseja lisab uue kauba koos kogu lisainfoga.</p>
            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba aktiivseks seadmine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b> Antud allsüsteemis töötav tegutseja seab lisatud kauba aktiivseks, mis tähendab
                    seda, et nüüd on kaup klientidele nähtav ning nad saavad seda tellida.</p>
            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba mitteaktiivseks seadmine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b> Antud allsüsteemis töötav tegutseja seab lisatud kauba mitteaktiivseks, mis
                    tähendab mis tähendab seda, et nüüd kaup ei ole klientidele nähtav ning nad ei saa seda tellida.</p>
            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba vaatamine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik, Uudistaja</p>

                <p><b>Kirjeldus:</b>Antud allsüsteemis töötav tegutseja avab kauba detailvaate, kus näeb kogu kauba
                    kohta käivat infot.</p>
            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba info muutmine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b>Antud allsüsteemis töötav tegutseja muudab/parandab kauba kohta käivaid andmeid.</p>
            </div>
            <br>

            <p><b>Kasutusjuht:</b>Kauba kustutamine</p>

            <div>
                <p><b>Tegutsejad:</b>Infosüsteemi administraator, Kaupade haldur, Omanik</p>

                <p><b>Kirjeldus:</b>Antud allsüsteemis töötav tegutseja kustutab kauba.</p>
            </div>
            <br>

        </div>
        <h3>1.2.6 Mittefunktsionaalsed nõuded</h3>
        <table>
            <tr>
                <td><b>Tüüp</b></td>
                <td><b>Nõude kirjeldus</b></td>
            </tr>
            <tr>
                <td>Serveri tarkvara</td>
                <td>Süsteem kasutab andmete hoidmiseks SQL-andmebaasisüsteemi
                    abiga loodud andmebaasi. Maksumuse vähendamiseks on serveri operatsioonisüsteemina on kasutusel
                    Linux.
                </td>
            </tr>
            <tr>
                <td>Arendusvahendid</td>
                <td>Arendusvahendina tuleks kasutada CASE tarkvara Rational Rose.</td>
            </tr>
            <tr>
                <td>Keel</td>
                <td>Süsteemi kasutajaliides ja dokumentatsioon peavad olema eesti
                    keeles. Süsteem tuleks üles ehitada nii, et ei oleks väga raske
                    lisada kasutajaliidesesse uusi keeli (inglise keel).
                </td>
            </tr>
            <tr>
                <td>Kasutajaliides</td>
                <td>Kasutajaliides on veebipõhine. Kasutajaliidese värvivalikus tuleb kasutada terashalle toone.</td>
            </tr>
            <tr>
                <td>Andmebaasioperatsioonide töökiirus</td>
                <td>Päringu tegemisel ei tohi vastuse kuvamine võtta aega rohkem
                    kui 5 sekundit. Andmete muudatuse salvestamine süsteemi
                    poolt ei tohi võtta aega rohkem kui 5 sekundit.
                </td>
            </tr>
            <tr>
                <td>Töökindlus</td>
                <td>Kaupade arvestus peab toimima tõrgeteta, et e-pood toodaks maksimaalset kasu. Tõrked
                    tekitaksid organisatsioonile suurt rahalist kahju. <br>
                    <br>Taasteaja siht (recovery time objective)("maksimaalne talutav
                    süsteemi käideldamatuse kestus pärast intsidenti" (AKIT, 2015)): Juhul kui
                    tekib veaolukord ja andmebaas või rakendus kahjustub, siis
                    tuleb need taastada viimase tehtud varukoopia põhjal.<br>
                    <br>Taasteseisu siht (recovery point objective)("intsidendijärgsele
                    taastele seatud eesmärk ajahetkena, millele eelnevad andmed peavad olema
                    täielikult taastatud (näiteks eelmine tund, eelmine tööpäev, eelmine
                    nädal)"(AKIT, 2015)): Maksimaalselt võivad kaotsi minna viimase 24
                    tunni andmed, st. et sellele eelnevad andmed peavad olema
                    täielikult taastatud.

                </td>
            </tr>
            <tr>
                <td>Varukoopiad</td>
                <td>Kuna hallatavad andmed on organisatsiooni jaoks väga olulised, siis tuleb
                    vähemalt kord nädalas teha andmetest varukoopia ja säilitada koopiaid mitmes erinevas asukohas.
                </td>
            </tr>
            <tr>
                <td>Turvalisus</td>
                <td>Määran vastuvõtuaegade haldamise süsteemi turvaklassi põhinedes infosüsteemi turvameetmete
                    süsteemil: https://www.riigiteataja.ee/akt/13125331?leiaKehtiv. E-poe kauba arvestuse allsüsteem
                    teenindab kauba arvestuse registrit. Kauba arvestuse register võiks olla:
                    K1T1S2 K1 – töökindlus – 90% (lubatud summaarne seisak nädalas ~
                    ööpäev); lubatav nõutava reaktsiooniaja kasv tippkoormusel –
                    tunnid (1÷10).
                    T1 – info allikas, selle muutmise ja hävitamise fakt peavad
                    olema tuvastatavad; info õigsuse, täielikkuse ja ajakohasuse
                    kontroll erijuhtudel ja vastavalt vajadusele;
                    S2 – salajane info: info kasutamine on lubatud ainult teatud
                    kindlatele kasutajate gruppidele, juurdepääs teabele on lubatav
                    juurdepääsu taotleva isiku õigustatud huvi korral;
                    Kui parooli hoitakse andmebaasis, siis ei tohi see olla avatekst,
                    vaid peab olema parooli räsiväärtus, mis on leitud selle parooli
                    jaoks genereeritud soola kasutades.
                </td>
            </tr>
        </table>
    </div>
    <h2>1.3 Kaupade register</h2>

    <div>
        <h3>1.3.1 Eesmärgid</h3>

        <div>
            <p>
                Säilitada informatsiooni kaupade arvestuse kohta sellises mahus, et oleks tagatud kaupade arvestuse
                funktsionaalses allsüsteemis defineeritud eesmärkide täitmine.
            </p>
        </div>
        <h3>1.3.2 Registrit kasutavad pädevusalad</h3>

        <p> Registrist loevad andmeid ja muudavad andmeid infosüsteemi administraator, kaupade haldur ning omanik.</p>

        <h3>1.3.3 Registrit teenindavad funktsionaalsed allsüsteemid</h3>

        <p>Kaupade registri andmeid kasutab ja uuendab kaupade arvestuse funktsionaalnse allsüsteem.</p>

        <h3>1.3.4 Infovajadused, mida register aitab rahuldada</h3>
        <ul>
            <li>Nimekiri veebipoe kaupadest</li>
            <li>Nimekiri kaupade omadustest</li>
        </ul>

        <h3>1.3.5 Seosed teiste registritega</h3>
        <ul>
            <li><b>Klassifikaatorite register</b> - Kaubal on erinevaid klassifikaatoreid, näiteks staatus ja
                kategooria.
            </li>
            <li><b>Töötajate register</b> - Seotud olemitüübi <b>Töötaja</b> kaudu. Kindel töötaja lisas kauba.</li>
            <li><b>Organisatsioonide register</b> - Seotud olemitüübi <b>Organisatsioon</b> kaudu. Seotud olemitüübi <b>Tootja</b>
                ja <b>Tarnija</b> kaudu
            </li>
        </ul>

        <h3>1.3.6 Ärireeglid</h3>
        <ul>
            <li>Igal kaubal on üks töötaja, kes selle lisas.</li>
            <li>Kaubal on üks tootja.</li>
            <li>Kaubal on üks tarnija.</li>
            <li>Kaupade register tegeleb ainult kauba metaandmetega.</li>
            <li>Kauba hinne on 0-5 ning võib olla komakohtadega.</li>
            <li>Hind on suurem kui null ning komakohtadega</li>
            <li>email on unikaalne ning kasutusel kasutajanimena</li>
            <li>Kauba kood on unikaalne</li>
            <li>Organisatsioon peab olema kas tootja või tarnija</li>
            <li>Kaupa saab luua ainult aktiivsena</li>
            <li>Kaupa ei saa kustutada andmebaasist, saab ainult teha nö "soft delete-i"</li>
            <li>Kustutatud kauba infot ei saa uuendada</li>
        </ul>
        <h3>1.3.7 Registri kontseptuaalne eskiismudel</h3>
        <img src="img/Eskiismudel.png" alt="registri eskiismudeli pilt ">
    </div>
</div>
<h1>2. Detailanalüüsi etapp</h1>

<div>
    <h2>2.1 Kaupade arvestuse funktsionaalne allsüsteem</h2>

    <div>
        <h3>2.1.1 Kasutusjuhtude mudel</h3>

        <div>
            <p>Punasega viidatakse andmebaasioperatsioonidele, mis seisnevad ainult andmete lugemises. Sinisega
                viidatakse andmebaasioperatsioonidele, mis tegelevad andmebaasis andmete muutmisega. </p>

            <div>
                <u><p><b>Kasutusjuht:</b>Töötaja tuvastamine (süsteemiülene)</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad siseneda süsteemi ja teha
                    tegevusi oma volituste piires</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi süsteemi sisenemiseks.</p>

                <p><b>Eeltingimused:</b>Subjektil on loodud süsteemi kasutaja.</p>

                <p><b>Järeltingimused:</b>Subjekti õigus süsteemi sisenemiseks on tehtud kindlaks. Subjekt on autenditud
                    ning ta saab kasutada süsteemi funktsioone talle määratud volituste piires.</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib siseneda süsteemi.</li>
                    <li>Süsteem palub subjektil ennast identifitseerida.</li>
                    <li>Subjekt identifitseerib ennast (sisestades emaili (kasutajanime), parooli).</li>
                    <li>Süsteem kontrollib, kas sisestatud kasutajatunnuse ja parooliga subjekti andmed eksisteerib
                        süsteemis või mitte <font color="red">(OP1.1)</font>.
                    </li>
                    <li>Süsteem annab subjektile volituse süsteemi kasutada.</li>
                    <i>Subjekt võib üritada süsteemi siseneda kuni kolm korda.</i>
                </ol>
                <p><b>Laiendused (või alternatiivne sündmuste käik):</b></p>

                <p>5a. Kui süsteem ei leia subjekti sisestatud kasutajatunnuse ja parooliga andmeid süsteemist, ei saa
                    subjekt õigust süsteemi kasutada.</p>
                <ol>
                    <li>Süsteem annab subjektile teada, et sellist kasutajat pole ja ei anna talle süsteemi kasutamiseks
                        õigust.
                    </li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba lisamine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad lisada uusi kaupu e-poodi, et
                    müüa rohkem ja seeläbi teenida rohkem kasumit</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kauba lisamiseks.</p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt lisand kaupade nimekirja uue toote.</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib lisada uut kaupa</li>
                    <li>Süsteem avab talle kauba lisamise vormi.</li>
                    <li>Subjekt lisab kogu uue kauba kohta käiva info ning tema staatuse</li>
                    <li>Süsteem kontrollib, kas kaup ei ole juba lisatud.</li>
                    <li>Süsteem lisab kaupade nimekirja uue kauba <font color="blue">(OP2.1)</font>.</li>
                </ol>
                <p><b>Laiendused (või alternatiivne sündmuste käik):</b></p>

                <p>5a Kui süsteem näeb, et see kaup on juba olemas, siis ta annab sellest subjektile teada.</p>
                <ol>
                    <li>Süsteem teavitab subjekti et selline kaup on juba olemas ning soovitab tal vajadusel
                        olemasolevat kaupa vaadata.
                    </li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba aktiivseks seadmine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad muuta kauba nähtavaks ja
                    ostetavaks ostjatele.</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kauba staatust aktiivseks muuta</p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt kauba seadnud aktiivseks</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib muuta kaupa aktiivseks</li>
                    <li>Süsteem avab talle kauba detailvaate <font color="red">(OP5.1)</font>, kus saab muuta kaupa
                        aktiivseks.
                    </li>
                    <li>Subjekt avaldab soovi kaupa aktiivseks muuta</li>
                    <li>Süsteem muudab kauba staatuse aktiivseks. <font color="blue">(OP3.1)</font>.</li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba mitteaktiivseks seadmine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad muuta kaupa mitteostetavaks ja
                    mittenähtavaks ostjatele.</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kaupa seada mitteaktiivseks/p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt muutnud kauba staatuse mitteaktiivseks</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib muuta kauba mitteaktiivseks</li>
                    <li>Süsteem avab talle kauba detailvaate <font color="red">(OP5.1)</font>, kus saab muuta kaupa
                        mitte-aktiivseks.
                    </li>
                    <li>Subjekt avaldab soovi muuta kauba staatus mitteaktiivseks</li>
                    <li>Süsteem muudab kauba staatuse mitteaktiivseks <font color="blue">(OP4.1)</font>.</li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba vaatamine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad vaadata kauba kohta käivat
                    infot.</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kaupa vaadata.</p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt näinud kauba kohta käivat infot.</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib vaadata kaupa.</li>
                    <li>Süsteem avab talle kauba detailvaate <font color="red">(OP5.1)</font>.</li>
                    <li>Subjekt tutvub kauba kohta käiva infoga.</li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba info muutmine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad muuta kauba kohta käivaid
                    andmeid.</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kauba andmeid muuta.</p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt muutnud kauba andmeid.</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib muuta kauba andmeid</li>
                    <li>Süsteem avab talle kauba detailvaate <font color="red">(OP5.1)</font>, mida saab muuta.</li>
                    <li>Subjekt teeb vormil soovitud muutused.</li>
                    <li>Süsteem muudab andmebaasis kauba kohta käiva info <font color="blue">(OP6.1)</font>.</li>
                </ol>
            </div>
            <br>

            <div>
                <u><p><b>Kasutusjuht:</b>Kauba kustutamine</p></u>

                <p><b>Primaarne tegutseja: </b>Infosüsteemi haldur, Kaupade haldur, Omanik</p>

                <p><b>Osapooled ja nende huvid:</b> Kõik eelnimetatud tegutsejad soovivad kustutada kaupa.</p>

                <p><b>Käivitatav sündmus:</b>Subjekt avaldab soovi kauba kustutamiseks.</p>

                <p><b>Eeltingimused:</b>Subjekt on süsteemi sisse loginud.</p>

                <p><b>Järeltingimused:</b>Subjekt on edukalt muutnud kauba kustutanud</p>

                <p><b>Stsenaarium</b></p>
                <ol>
                    <li>Subjekt soovib kustutada kaupa kaupade nimekirjas.</li>
                    <li>Süsteem küsib kasutajalt kinnitust kustutamise operatsioonile.</li>
                    <li>Subjekt kinnitab kustutamise.</li>
                    <li>Süsteem kustutab kauba <font color="blue">(OP7.1)</font>.</li>
                </ol>
                <p><b>Laiendused (või alternatiivne sündmuste käik):</b></p>

                <p>3a Kui kasutaja ei kinnita kustutamist, näiteks vajutas kogemata valesti.</p>
                <ol>
                    <li>Süsteem ei kustuta kaupa ning midagi ei muutu.</li>
                </ol>
            </div>
            <br>

        </div>
    </div>
    <h2>2.2 Kaupade register (laiendatud kuju)</h2>

    <div>
        <h3>2.2.1 Kontseptuaalne andmemudel</h3>

        <div>
            <h4>2.2.1.1 Olemi-suhte diagramm</h4>
            <img src="img/Kontseptuaalne andmemudel.png" alt="olemi-suhte diagrammi pilt">
            <h4>2.2.1.2 Olemitüüpide definitsioonid</h4>
            <table border="1" style="width:100%">
                <tr>
                    <td><b>Olemitüübi nimi (aliased)</b></td>
                    <td><b>Kuuluvus registrisse</b></td>
                    <td><b>Definitsioon</b></td>
                </tr>
                <tr>
                    <td>organisatsioon</td>
                    <td>Organisatsioonide register</td>
                    <td>Organisatsioon on Tootja ja Tarnija üldistus</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>Kaupade register</td>
                    <td>Ostu-müügi objekt, mille tootmise eesmärgiks oli objekti müük, ehk majandusliku kasu saamine
                        tootjale.
                    </td>
                </tr>
                <tr>
                    <td>tootja</td>
                    <td>Organisatsioonide register</td>
                    <td>Tootja on kauba valmistanud äriettevõte.</td>
                </tr>
                <tr>
                    <td>tarnija</td>
                    <td>Organisatsioonide register</td>
                    <td>Tarnija on ettevõte, kes vahendab kauba tootjalt lõpp-müüjale majandusliku kasu teenimise
                        nimel
                    </td>
                </tr>

                <tr>
                    <td>tootaja</td>
                    <td>Töötajate register</td>
                    <td>Töötaja on töötegija mingis teatud asutuses või ettevõttes. Antud veebipoe puhul kaupade haldur,
                        omanik ning infosüsteemi administraator
                    </td>
                </tr>
                <tr>
                    <td>kauba_staatus</td>
                    <td>Klassifikaatorite register</td>
                    <td>Andmebaasis tuleb iga registreeritud kauba korral muuhulgas registreerida selle kauba hetke
                        staatus. Kui kauba staatus muutub, siis tuleb uus staatus andmebaasis registreerida.
                    </td>
                </tr>
                <tr>
                    <td>tootaja_staatus</td>
                    <td>Klassifikaatorite register</td>
                    <td>Andmebaasis tuleb iga registreeritud töötaja korral muuhulgas registreerida selle töötaja hetke
                        staatus. Kui töötaja staatus muutub, siis tuleb uus staatus andmebaasis registreerida.
                    </td>
                </tr>
                <tr>
                    <td>tootaja_roll</td>
                    <td>Klassifikaatorite register</td>
                    <td>Andmebaasis tuleb iga registreeritud töötaja korral muuhulgas registreerida selle töötaja hetke
                        roll. Kui töötaja roll muutub, siis tuleb uus roll andmebaasis registreerida.
                    </td>
                </tr>
                <tr>
                    <td>kauba_kategooria</td>
                    <td>Klassifikaatorite register</td>
                    <td>Igal kaubal on kategooria, kuhu ta kuulub, mis väljendab tema tüüpi, näiteks kas kaup on
                        emaplaat või termopasta.
                    </td>
                </tr>
                <tr>
                    <td>riik</td>
                    <td>Klassifikaatorite register</td>
                    <td>Iga organisatsioon kuulub ühte riiki.</td>
                </tr>
                <tr>
                    <td>organisatsiooni_tyyp</td>
                    <td>Klassifikaatorite register</td>
                    <td>Iga organisatsioon on kas tootja või tarnija tüüpi.</td>
                </tr>


            </table>
            <h4>2.2.1.3 Atribuutide definitsioonid</h4>
            <table border="1" style="width:100%">
                <tr>
                    <td><b>Olemitüübi nimi</b></td>
                    <td><b>Atribuudi nimi</b></td>
                    <td><b>Atribuudi definitsioon</b></td>
                    <td><b>Näiteväärtus</b></td>
                </tr>
                <tr>
                    <td>organisatsioon</td>
                    <td>organisatsiooni_kood</td>
                    <td>Osapoole unikaalne kood.<br>
                        {Organisatsiooni_kood on unikaalne kohustuslik täisarvuline number ning seatakse antud veebipoe
                        poolt.}
                    </td>
                    <td>11027462</td>
                </tr>
                <tr>
                    <td>organisatsioon</td>
                    <td>registri_kood</td>
                    <td>Osapoole registri number.<br>
                        {Registri kood koosneb tähtedest ja numbritest ning ei tohi olla tühi string või koosneda ainult
                        tühikutest.}
                    </td>
                    <td>110A2746B2C</td>
                </tr>

                <tr>
                    <td>organisatsioon</td>
                    <td>nimi</td>
                    <td>Vastava organisatsiooni nimi. <br>
                        {Nimi ei tohi olla tühi string või ainult tühikutest koosnev string.}
                    </td>
                    <td>Samsung</td>
                </tr>
                <tr>
                    <td>organisatsioon</td>
                    <td>aadress</td>
                    <td>Tarnija aadress. <br>
                        {Aadress ei tohi olla tühi string või ainult tühikutest koosnev string.}
                    </td>
                    <td>Akadeemia tee 5, Tallinn 93811, Eesti</td>
                </tr>
                <tr>
                    <td>organisatsioon</td>
                    <td>e_mail</td>
                    <td>Organisatsiooni kontakt e-mail. <br>
                        {e_mail peab sisaldama "@" märki ning on unikaalne}
                    </td>
                    <td>kontakt@org.ru</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>kauba_kood</td>
                    <td>Kaupa unikaalselt identifitseeriv kood. <p>{Kohustuslik kauba kood ei tohi olla tühi või ainult
                        tühikutega string.}</p></td>
                    <td>123456789</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>nimetus</td>
                    <td>Kauba täielik nimetus <br>
                        {Kohustuslik unikaalne nimi ei tohi olla tühi string või ainult tühikutest koosnev string.}
                    </td>
                    <td>Dell Inspiron 15R n5010</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>hind</td>
                    <td>Antud toote väljamüügi hind eurodes. <br>
                        {Peab sisaldama ainult numbreid ja on kohustuslik. Hind on eurodes. Ei tohi olla negatiivne ning
                        on kohustuslik.
                        Hind sisaldab käibemaksu. Hind võib sisaldada kuni kahte komakohta}
                    </td>
                    <td>15.00</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>korgus</td>
                    <td>Antud toote kõrgus millimeetrites. <br>
                        {Kõrgus on positiivne täisarvuline number. }
                    </td>
                    <td>200</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>laius</td>
                    <td>Antud toote laius millimeetrites. <br>
                        {Kõrgus on positiivne täisarvuline number.}
                    </td>
                    <td>200</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>pikkus</td>
                    <td>Antud toote pikkus millimeetrites. <br>
                        {Kõrgus on positiivne täisarvuline number.}
                    </td>
                    <td>200</td>
                </tr>
                <tr>
                    <td>kaup</td>
                    <td>pildi_aadress</td>
                    <td>Antud toote pildi aadress. <br>
                        {Pildi aadress on URL ja peab algama http, httpsi või ftp-ga, et olla valiidne}
                    </td>
                    <td>http://i.imgur.com/7SQ2f6r.gif</td>
                </tr>
                <tr>
                    <td>tootja</td>
                    <td>hinne</td>
                    <td>Kauba tootjale antud hinnang tema toodete kvaliteedi kohta <br>
                        {Peab sisaldama ainult numbreid nullist viieni, võib olla kuni kahe komakohaga.}
                    </td>
                    <td>5.0</td>
                </tr>
                <tr>
                    <td>tarnija</td>
                    <td>tarneaeg</td>
                    <td>Tarnija poolt lubatud maksimaalne tarneaeg päevades. <br>
                        {Peab sisaldama ainult numbreid. Võib sisaldada kuni kahte komakohta. Ei tohi olla negatiivne}
                    </td>
                    <td>5.0</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>tootaja_kood</td>
                    <td>Tootaja väärtust esitav kood, mida saab kasutada selle väärtuse lühidalt esitamiseks. <br>
                        {Kood on täisarv ning on kohustuslik. Töötaja kood on unikaalne ja primaarvõti.}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>isikukood</td>
                    <td>Tootaja Eesti isikukood koosneb numbritest. <br>
                        {Unikaalne kohustuslik 11 numbriline isikukood ei ole tühi või tühikutest koosnev. Vastab Eesti
                        isikoodi formaadile.}
                    </td>
                    <td>1123adsa21312</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>e_mail</td>
                    <td>Töötaja töö e-mail. <br>
                        {Kohustuslik e_mail peab sisaldama "@" märki. E-mail on unikaalne, kasutatakse
                        kasutajatunnusena}
                    </td>
                    <td>mari.mets@firma.ee</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>eesnimi</td>
                    <td>Töötaja eesnimi <br>
                        {Eesnimi ei tohi olla tühi string või ainult tühikutest koosnev string. Eesnimi võib sisaldada
                        ainult tähti, tühikuid või kriipse. Eesnimi algab suure tähega. Ülejäänud tähed on väikesed. Kui
                        inimesel on mitu eesnime, siis need on eraldatud ühe tühiku või kriipsuga. Ka iga järgnev
                        eesnimi algab suure tähega.}
                    </td>
                    <td>Mari</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>perenimi</td>
                    <td>Töötaja perenimi <br>
                        {Perenimi ei tohi olla tühi string või ainult tühikutest koosnev string. Perenimi võib sisaldada
                        ainult tähti, tühikuid või kriipse. Perenimi algab suure tähega. Ülejäänud tähed on väikesed.
                        Kui inimesel on mitu perenime, siis need on eraldatud ühe tühiku või kriipsuga. Ka iga järgnev
                        perenimi algab suure tähega.}
                    </td>
                    <td>Mets</td>
                </tr>
                <tr>
                    <td>tootaja</td>
                    <td>parool</td>
                    <td>Töötaja kasutajatunnusega seotud töötaja identsust tõendav teadmuslik (miski, mida töötaja teab)
                        volitustõend. <br>
                        {String pole tühi või tühikutest koosnev, parooliväljal hoitakse andmebaasis hashi.}
                    </td>
                    <td>marisupertugevaparoolihash</td>
                </tr>

                <tr>
                    <td>tootaja_staatus</td>
                    <td>töötaja_staatuse_kood</td>
                    <td>Töötaja staatust esitav kood, mida saab kasutada selle väärtuse lühidalt esitamiseks.<br>
                        {Täisarvuline unikaalne kohustuslik number}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>tootaja_staatus</td>
                    <td>nimetus</td>
                    <td>Staatuse nimetus.<br>
                        {Ei tohi olla tühi ega tühikutest koosnev string on unikaalne ja kohustuslik}
                    </td>
                    <td>aktiivne</td>
                </tr>
                <tr>
                    <td>tootaja_staatus</td>
                    <td>kirjeldus</td>
                    <td>Staatuse kirjeldus. <br>
                        {kohustuslik}
                    </td>
                    <td>Töötaja on mitteaktiivne ja ei saa süsteemi opereerida.</td>
                </tr>
                <tr>
                    <td>tootaja_roll</td>
                    <td>töötaja_rolli_kood</td>
                    <td>Töötaja rolli esitav kood, mida saab kasutada selle väärtuse lühidalt esitamiseks.<br>
                        {Täisarvuline unikaalne kohustuslik number}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>tootaja_roll</td>
                    <td>nimetus</td>
                    <td>Rolli nimetus.<br>
                        {Ei tohi olla tühi ega tühikutest koosnev string on unikaalne ja kohustuslik}
                    </td>
                    <td>Kaupade haldur</td>
                </tr>
                <tr>
                    <td>tootaja_roll</td>
                    <td>kirjeldus</td>
                    <td>Rolli kirjeldus. <br>
                        {kohustuslik}
                    </td>
                    <td>Halduril on ligipääs kogu süsteemile.</td>
                </tr>
                <tr>
                    <td>kauba_staatus</td>
                    <td>kauba_staatuse_kood</td>
                    <td>Kauba staatust esitav kood, mida saab kasutada selle väärtuse lühidalt esitamiseks.<br>
                        {Täisarvuline unikaalne kohustuslik number}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>kauba_staatus</td>
                    <td>nimetus</td>
                    <td>Staatuse nimetus.<br>
                        {Ei tohi olla tühi ega tühikutest koosnev string on unikaalne ja kohustuslik}
                    </td>
                    <td>aktiivne</td>
                </tr>
                <tr>
                    <td>kauba_staatus</td>
                    <td>kirjeldus</td>
                    <td>Staatuse kirjeldus.</td>
                    <td>Kaup on aktiivne ning müügis.</td>
                </tr>
                <tr>
                    <td>kauba_kategooria</td>
                    <td>kauba_kategooria_kood</td>
                    <td>Kauba kategooriat esitav kood, mida saab kasutada selle väärtuse lühidalt esitamiseks.<br>
                        {Täisarvuline unikaalne kohustuslik number, primaarvõti}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>kauba_kategooria</td>
                    <td>nimetus</td>
                    <td>Kategooria nimetus.<br>
                        {ei tohi olla tühi ega tühikutest koosnev string, on kohustuslik. Nimetus ja ülemkategooria on
                        koos unikaalsed.}
                    </td>
                    <td>emaplaadid</td>
                </tr>
                <tr>
                    <td>kauba_kategooria</td>
                    <td>kirjeldus</td>
                    <td>Kategooria kirjeldus.
                    </td>
                    <td>mATX korpusele sobivad emaplaadid.</td>
                </tr>
                <tr>
                    <td>riik</td>
                    <td>riigi_kood</td>
                    <td>ISO 3166 standardile vastav 2-täheline riigi identifikaator.<br>
                        {peab sisaldama 2 tähte A-Z, kohustuslik, unikaalne ning primaarvõti}
                    </td>
                    <td>EE</td>
                </tr>
                <tr>
                    <td>riik</td>
                    <td>nimi</td>
                    <td>Riigi nimi. <br>
                        {ei tohi olla tühi ega tühikutest koosnev string, on kohustuslik, on unikaalne}
                    </td>
                    <td>Eesti</td>
                </tr>
                <tr>
                    <td>organisatsiooni_tyyp</td>
                    <td>organisatsiooni_tyybi_kood</td>
                    <td>Organisatsiooni tüüpi väljendav kood <br>
                        {Täisarvuline kohustuslik unikaalne primaarvõti}
                    </td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>organisatsiooni_tyyp</td>
                    <td>organisatsiooni_tyybi_nimetus</td>
                    <td>Väljendab mis tüüpi organisatsioon on <br>
                        {ei tohi olla tühi ega tühikutest koosnev string, on kohustuslik, on unikaalne}
                    </td>
                    <td>tarnija</td>
                </tr>


            </table>
        </div>
        <h3>2.2.2 Andmebaasioperatsioonide lepingud</h3>

        <div>
            <p><font color="blue">(OP2.1)</font> <b><u>Kauba loomine((kauba_kood, nimetus, pikkus, kõrgus, laius, pildi
                aadress, hind, viide kauba_kategooriale, viide Tootjale, viide Tarnijale, viide Töötajale)</u></b></p>

            <p><b>Eeltingimused:</b></p>
            <ul>
                <li>Tootja ja Tarnija on registreeritud.</li>
                <li>Töötaja on sisse logitud.</li>
            </ul>
            <p><b>Järeltingimused:</b></p>
            <ul>
                <li>On loodud uus Kaup.</li>
                <li>Kaup.kauba_kood = kauba unikaalne kood.</li>
                <li>Kaup.nimetus = kauba nimetus.</li>
                <li>Kaup.hind = väljamüügi hind.</li>
                <li>Kaup on seotud Kauba_staatus’ega „aktiivne“.</li>
                <li>Kaup on seotud kauba kategooriaga</li>
                <li>Kaubale on seatud pikkus, kõrgus, laius ja pildi aadress.</li>
                <li>Kaup on seotud tema tootnud Tootjaga.</li>
                <li>Kaup on seotud tema lisanud Töötajaga.</li>
                <li>Kaup on seotud Tarnijaga, kes ta veebipoele tarnib.</li>
            </ul>
            <p><b>Kasutus kasutusjuhtude poolt:</b> Kauba lisamine</p>
        </div>
        <br>

        <div>
            <p><font color="blue">(OP3.1)</font> <b><u>Kauba aktiivseks seadmine(viide Kaubale)</u></b></p>

            <p><b>Eeltingimused:</b></p>
            <ul>
                <li>Kaup on loodud</li>
                <li>Kaup on seotud Kauba_staatus’ega „mitteaktiivne“.</li>
            </ul>
            <p><b>Järeltingimused:</b></p>
            <ul>
                <li>Kaup on seotud Kauba_staatus’ega „aktiivne“.</li>
            </ul>
            <p><b>Kasutus kasutusjuhtude poolt:</b> Kauba aktiivseks seadmine</p>
        </div>
        <br>

        <div>
            <p><font color="blue">(OP4.1)</font> <b><u>Kauba mitteaktiivseks seadmine(viide Kaubale)</u></b></p>

            <p><b>Eeltingimused:</b></p>
            <ul>
                <li>Kaup on loodud</li>
                <li>Kaup on seotud Kauba_staatus’ega „aktiivne“.</li>
            </ul>
            <p><b>Järeltingimused:</b></p>
            <ul>
                <li>Kaup on seotud Kauba_staatus’ega „mitteaktiivne“.</li>
            </ul>
            <p><b>Kasutus kasutusjuhtude poolt:</b> Kauba mitteaktiivseks seadmine</p>
        </div>
        <br>

        <div>
            <p><font color="blue">(OP6.1)</font> <b><u>Kauba info muutmine(kauba_kood, hind, nimetus, pikkus, kõrgus,
                laius, pildi aadress, viide kauba_kategooriale, viide Tootjale, viide Tarnijale)</u></b></p>

            <p><b>Eeltingimused:</b></p>
            <ul>
                <li>Kaup on loodud</li>
            </ul>
            <p><b>Järeltingimused:</b></p>
            <ul>
                <li>Kaup.kauba_kood = kauba unikaalne kood.</li>
                <li>Kaup.nimetus = kauba nimetus.</li>
                <li>Kaup.hind = väljamüügi hind.</li>
                <li>Kaup on seotud kauba staatusega.</li>
                <li>Kaup on seotud Kauba kategooria kuhu kaup kuulub</li>
                <li>Kaubale on seatud uus pikkus, kõrgus, laius ja pildi aadress.</li>
                <li>Kaup on seotud tema tootnud Tootjaga.</li>
                <li>Kaup on seotud Tarnijaga, kes ta veebipoele tarnib.</li>
            </ul>
            <p><b>Kasutus kasutusjuhtude poolt:</b> Kauba info muutmine</p>
        </div>
        <br>

        <div>
            <p><font color="blue">(OP7.1)</font> <b><u>Kauba kustutamine(viide Kaubale, kauba_staatus)</u></b></p>

            <p><b>Eeltingimused:</b></p>
            <ul>
                <li>Kaup on loodud</li>
            </ul>
            <p><b>Järeltingimused:</b></p>
            <ul>
                <li>Kaup on seotud Kauba_staatus’ega „kustutatud“.</li>
            </ul>
            <p><b>Kasutus kasutusjuhtude poolt:</b> Kauba kustutamine</p>
        </div>
        <br>

        <h3>2.2.3 Registri põhiobjekti seisundidiagramm</h3>

        <div>
            <img src="img/Kauba seisundidiagramm.png"/>
        </div>
    </div>

    <h2>2.3 CRUD-maatriks</h2>

    <p>See CRUD maatriks esitatakse olemitüüpide ja kasutusjuhtude täpsusega. Maatriksi veergudele vastavad kasutusjuhud
        ja ridadele olemitüübid. </p>

    <p> Oranžil taustal on esitatud olemitüübid, mis kuuluvad vaadeldava allsüsteemi teenindatavasse registrisse.</p>
    <table border="1" style="width:50%">
        <tr>
            <td>Kasutusjuhud<br>Olemitüübid</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>Kokku</td>
        </tr>
        <tr bgcolor="#EA7B30">
            <td>kaup</td>
            <td></td>
            <td>CR</td>
            <td>RU</td>
            <td>RU</td>
            <td>R</td>
            <td>RU</td>
            <td>RU</td>
            <td>CRU</td>
        </tr>
        <tr>
            <td>organisatsioon</td>
            <td></td>
            <td>R</td>
            <td></td>
            <td></td>
            <td>R</td>
            <td></td>
            <td>R</td>
            <td>R</td>
        </tr>
        <tr>
            <td>tootaja</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
        </tr>
        <tr>
            <td>kauba_staatus</td>
            <td></td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
        </tr>
        <tr>
            <td>kauba_kategooria</td>
            <td></td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
        </tr>
        <tr>
            <td>riik</td>
            <td></td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
        </tr>
        <tr>
            <td>organisatsiooni_tyyp</td>
            <td></td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
            <td>R</td>
        </tr>


    </table>
    <p>Kasutusjuhtude nimekiri:</p>
    <ol>
        <li>Töötaja tuvastamine</li>
        <li>Kauba lisamine</li>
        <li>Kauba aktiivseks seadmine</li>
        <li>Kauba mitteaktiivseks seadmine</li>
        <li>Kauba vaatamine</li>
        <li>Kauba info muutmine</li>
        <li>Kauba kustutamine</li>
    </ol>

    <h2>2.4 Infosüsteemi rollide kirjeldused</h2>

    <div>
        <table style="width:75%">
            <tr>
                <td><b>Rolli nimi</b></td>
                <td><b>Kirjeldus</b></td>
            </tr>
            <tr>
                <td>Infosüsteemi administraator</td>
                <td>Infosüsteemi administraator on arvutikaupade veebipoe süsteemi ning tellimuste haldur, kellel on
                    vajalikud õigused, et kindlustada infosüsteemi igapäevane tõrkevaba töö ning vajadusel teha muutusi
                    lähtekoodis. Seega on tal õigus vaadata kõiki andmeid ning tegeleda tellimustega, kuid tal pole
                    õigust kõiki andmeid lisada/muuta/kustutada.
                </td>
            </tr>
            <tr>
                <td>Kaupade haldur</td>
                <td>Kaupade haldur on veebipoes töötav ja kaupade haldamisega tegelev isik. Kaupade haldur on õigus
                    kaupu lisada, muuta, kustutada ning staatuseid muuta. Kaupde halduril puudub õigus vaadata kõiki
                    tellimusi ega tellimuste staatuste liiki muuta.
                </td>
            </tr>
            <tr>
                <td>Omanik</td>
                <td>Omanik on arvutikaupade veebipoes töötav ja organisatsiooni äristrateegiaga tegelev isik. Omanikul,
                    kui äriettevõtte juhil on õigus teha veebipoes kõike - ta võib muuta, kustutada ning lisada kõiki
                    andmeid, st ka tellimusi kinnitada jne.
                </td>
            </tr>
        </table>
    </div>

</div>
<h1>3. Füüsiline disain</h1>

<div>
    <h2>3.1 Laiendatud kaupade registri füüsiline disain</h2>

    <div>
        <h3>3.1.1 Füüsiline andmebaasiskeem</h3>

        <div>
            <img src="img/Kaupade register.png"/><br/>
            <h4>Joonis 1. Kaupade registri füüsiline disaini andmebaasi diagramm</h4>

            <img src="img/Klassifikaatorite register.png"/><br/>
            <h4>Joonis 2. Klassifikaatorite registri füüsiline disaini andmebaasi diagramm</h4>

            <img src="img/Organisatsioonide register.png"/><br/>
            <h4>Joonis 3. Organisatsioonide registri füüsiline disaini andmebaasi diagramm</h4>

            <img src="img/Töötajate register.png"/><br/>
            <h4>Joonis 4. Töötajate registri füüsiline disaini andmebaasi diagramm</h4>
        </div>
    </div>
</div>
<h1>4 Realisatsioon PostgreSQLis</h1>

<div>
    Andmebaasi loomiseks kasutatakse andmebaasisüsteemi <b>PostgreSQL (9.4)</b>.
    <div>
        <h2>4.1 Andmebaasi loomine</h2>
        Andmebaasis <i>kaupade arvestus</i> kasutatav märkide klassifikatsioon ja märkide
        võrdlusreeglistik vastavad eesti keele reeglitele. <br>

        <br>createdb -l et_EE.utf8 -T template0 kaupade arvestus <br>

        <br> Järgnevalt esitatakse SQL laused selle andmebaasiobjektide loomiseks
    </div>
    <h2>4.2 Skeemid</h2>

    <div>
        Loon skeemiobjektid skeemis nimega public, mis loodi andmebaasi loomisel automaatselt.
    </div>
    <h2>4.3 Domeenid</h2>

    <div>
        CREATE DOMAIN <b>d_nimetus</b> varchar(100) NOT NULL DEFAULT 'nimetu'
        CHECK (VALUE !~ '^\s*$');<br><br>

        ALTER TABLE kauba_kategooria DROP CONSTRAINT IF EXISTS CHK_kauba_kategooria_nimetus_ei_ole_tyhi;<br>
        ALTER TABLE kauba_staatus DROP CONSTRAINT IF EXISTS CHK_kauba_staatuse_nimetus_ei_ole_tyhi;<br>
        ALTER TABLE tootaja_staatus DROP CONSTRAINT IF EXISTS CHK_tootaja_staatuse_nimetus_ei_ole_tyhi;<br>
        ALTER TABLE tootaja_roll DROP CONSTRAINT IF EXISTS CHK_tootaja_rolli_nimetus_ei_ole_tyhi;<br>
        ALTER TABLE organisatsiooni_tyyp DROP CONSTRAINT IF EXISTS
        CHK_organisatsiooni_tyybi_nimetus_ei_ole_tyhi;<br><br>

        ALTER TABLE kauba_kategooria ALTER COLUMN nimetus TYPE d_nimetus;<br>
        ALTER TABLE kauba_staatus ALTER COLUMN nimetus TYPE d_nimetus;<br>
        ALTER TABLE tootaja_staatus ALTER COLUMN nimetus TYPE d_nimetus;<br>
        ALTER TABLE tootaja_roll ALTER COLUMN nimetus TYPE d_nimetus;<br>
        ALTER TABLE organisatsiooni_tyyp ALTER COLUMN organisatsiooni_tyybi_nimetus TYPE d_nimetus;<br>
    </div>
    <h2>4.4 Tabelid ja arvujada generaatorid</h2>

    <div>

        CREATE TABLE tootaja_staatus<br>
        (<br>
        tootaja_staatuse_kood smallint NOT NULL,<br>
        nimetus varchar(50) NOT NULL,<br>
        kirjeldus varchar(50) NOT NULL,<br>
        CONSTRAINT PK_tootaja_staatus PRIMARY KEY (tootaja_staatuse_kood),<br>
        CONSTRAINT UK_tootaja_staatus_on_unikaalne UNIQUE (nimetus),<br>
        CONSTRAINT CHK_tootaja_staatuse_nimetus_ei_ole_tyhi CHECK (nimetus !~ '^\s*$')<br>
        )<br>
        ;<br><br>

        CREATE TABLE tootaja_roll<br>
        (<br>
        tootaja_rolli_kood integer NOT NULL,<br>
        nimetus varchar(50) NOT NULL,<br>
        kirjeldus varchar(50) NOT NULL,<br>
        CONSTRAINT PK_tootaja_roll PRIMARY KEY (tootaja_rolli_kood),<br>
        CONSTRAINT UK_tootaja_rolli_nimetus_on_unikaalne UNIQUE (nimetus)<br>
        )<br>
        ;<br><br>

        CREATE TABLE tootaja<br>
        (<br>
        tootaja_kood serial NOT NULL,<br>
        isikukood char(11) NOT NULL,<br>
        tootaja_rolli_kood integer NOT NULL,<br>
        tootaja_staatuse_kood smallint NOT NULL DEFAULT 1,<br>
        e_mail varchar(255) NOT NULL,<br>
        eesnimi varchar(50) NOT NULL,<br>
        perenimi varchar(50) NOT NULL,<br>
        parool varchar(60) NOT NULL,<br>
        CONSTRAINT PK_tootaja PRIMARY KEY (tootaja_kood),<br>
        CONSTRAINT UK_e_mail_on_unikaalne UNIQUE (e_mail),<br>
        CONSTRAINT UK_isikukood_on_unikaalne UNIQUE (isikukood),<br>
        CONSTRAINT CHK_eesnimi_on_tahed CHECK (eesnimi ~ '^[[:alpha:] \-]+$'),<br>
        CONSTRAINT CHK_isikukood_on_11_numbrit CHECK (isikukood ~ '^[0-9]{11}$'),
        CONSTRAINT CHK_email_on_korrektses_formaadis CHECK (e_mail ~* '^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$'),<br>
        CONSTRAINT CHK_perenimi_on_tahed CHECK (perenimi ~ '^[[:alpha:] \-]+$'),<br>
        CONSTRAINT FK_tootaja_tootaja_roll FOREIGN KEY (tootaja_rolli_kood) REFERENCES tootaja_roll (tootaja_rolli_kood)
        ON DELETE Cascade ON UPDATE Cascade,<br>
        CONSTRAINT FK_tootaja_tootaja_staatus FOREIGN KEY (tootaja_staatuse_kood) REFERENCES tootaja_staatus
        (tootaja_staatuse_kood) ON DELETE Cascade ON UPDATE Cascade<br>
        )<br>
        ;<br><br>

        CREATE TABLE riik<br>
        (<br>
        riigi_kood char(2) NOT NULL,<br>
        nimi varchar(70) NOT NULL,<br>
        CONSTRAINT PK_riik PRIMARY KEY (riigi_kood),<br>
        CONSTRAINT UK_riik_on_unikaalne UNIQUE (nimi),<br>
        CONSTRAINT CHK_riigi_nimi_ei_ole_tyhi CHECK (nimi !~ '^\s*$'),<br>
        CONSTRAINT CHK_riigi_kood_on_2_tahte CHECK (riigi_kood ~ '^[A-Z]{2}$')<br>
        )<br>
        ;<br><br>

        CREATE TABLE organisatsiooni_tyyp<br>
        (<br>
        organisatsiooni_tyybi_kood smallint NOT NULL,<br>
        organisatsiooni_tyybi_nimetus varchar(50) NOT NULL,<br>
        CONSTRAINT PK_organisatsiooni_tyyp PRIMARY KEY (organisatsiooni_tyybi_kood),<br>
        CONSTRAINT UK_organisatsiooni_tyybi_nimetus_on_unikaalne UNIQUE (organisatsiooni_tyybi_nimetus),<br>
        CONSTRAINT CHK_organisatsiooni_tyybi_nimetus_ei_ole_tyhi CHECK (organisatsiooni_tyybi_nimetus !~ '^\s*$')<br>
        )<br>
        ;<br><br>

        CREATE TABLE organisatsioon<br>
        (<br>
        organisatsiooni_kood serial NOT NULL,<br>
        organisatsiooni_tyybi_kood smallint NOT NULL,<br>
        riik char(2) NOT NULL,<br>
        aadress varchar(255) NOT NULL,<br>
        e_mail varchar(255) NOT NULL,<br>
        nimi varchar(255) NOT NULL,<br>
        registri_kood varchar(255) NOT NULL,<br>
        tarneaeg decimal(4,2) NULL,<br>
        hinne decimal(3,2) NULL,<br>
        CONSTRAINT PK_organisatsioon PRIMARY KEY (organisatsiooni_kood),<br>
        CONSTRAINT UK_org_on_riigiti_unikaalne UNIQUE (registri_kood,riik),<br>
        CONSTRAINT CHK_organisatsiooni_tarneaeg_pole_negatiivne CHECK (tarneaeg >= 0),<br>
        CONSTRAINT CHK_organisatsiooni_hinne_on_0_kuni_5 CHECK (hinne >= 0 AND hinne <= 5),<br>
        CONSTRAINT CHK_organisatsiooni_email_on_korrektne CHECK (e_mail ~*
        '^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$'),<br>
        CONSTRAINT CHK_organisatsiooni_registri_kood_on_alphanum CHECK (registri_kood ~ '^[A-Z0-9]+$'),<br>
        CONSTRAINT CHK_tarneaeg_ja_hinne_not_null CHECK (tarneaeg IS NOT NULL OR hinne IS NOT NULL),<br>
        CONSTRAINT FK_organisatsioon_organisatsiooni_tyyp FOREIGN KEY (organisatsiooni_tyybi_kood) REFERENCES
        organisatsiooni_tyyp (organisatsiooni_tyybi_kood) ON DELETE Cascade ON UPDATE Cascade,<br>
        CONSTRAINT FK_organisatsiooni_riik FOREIGN KEY (riik) REFERENCES riik (riigi_kood) ON DELETE Cascade ON UPDATE
        Cascade<br>
        )<br>
        ;<br><br>

        CREATE TABLE kauba_staatus<br>
        (<br>
        kauba_staatuse_kood smallint NOT NULL,<br>
        nimetus varchar(255) NOT NULL,<br>
        kirjeldus varchar(255) NULL,<br>
        CONSTRAINT PK_kauba_staatus PRIMARY KEY (kauba_staatuse_kood),<br>
        CONSTRAINT UK_kauba_staatuse_nimetus_on_unikaalne UNIQUE (nimetus),<br>
        CONSTRAINT CHK_kauba_staatuse_nimetus_ei_ole_tyhi CHECK (nimetus !~ '^\s*$')<br>
        )<br>
        ;<br><br>

        CREATE TABLE kauba_kategooria<br>
        (<br>
        kauba_kategooria_kood integer NOT NULL,<br>
        ylem_kategooria integer NULL,<br>
        nimetus varchar(255) NOT NULL,<br>
        kirjeldus varchar(255) NULL,<br>
        CONSTRAINT PK_kauba_kategooria PRIMARY KEY (kauba_kategooria_kood),<br>
        CONSTRAINT UK_kauba_kategooria_nimetus_ja_ylemk_on_unikaalne UNIQUE (nimetus, ylem_kategooria),<br>
        CONSTRAINT CHK_kauba_kategooria_nimetus_ei_ole_tyhi CHECK (nimetus !~ '^\s*$'),<br>
        CONSTRAINT FK_kauba_ylemkategooria FOREIGN KEY (ylem_kategooria) REFERENCES kauba_kategooria
        (kauba_kategooria_kood) ON DELETE Cascade ON UPDATE Cascade<br>
        )<br>
        ;<br><br>

        CREATE TABLE kaup<br>
        (<br>
        kauba_kood varchar(20) NOT NULL,<br>
        kauba_staatus smallint NOT NULL,<br>
        kauba_kategooria integer NOT NULL,<br>
        tarnija integer NOT NULL,<br>
        tootja integer NOT NULL,<br>
        tootaja integer NOT NULL,<br>
        nimetus varchar(255) NOT NULL,<br>
        hind decimal(19,2) NOT NULL,<br>
        korgus integer NULL,<br>
        laius integer NULL,<br>
        pikkus integer NULL,<br>
        pildi_aadress varchar(255) NULL,<br>
        CONSTRAINT PK_kaup PRIMARY KEY (kauba_kood),<br>
        CONSTRAINT UK_kauba_nimetus_on_unikaalne UNIQUE (nimetus),<br>
        CONSTRAINT CHK_kauba_kood CHECK (kauba_kood ~ '^\d+$'),<br>
        CONSTRAINT CHK_kauba_nimetus_ei_ole_tyhi CHECK (nimetus !~ '^\s*$'),<br>
        CONSTRAINT CHK_kauba_hind_pole_negatiivne CHECK (hind >= 0),<br>
        CONSTRAINT CHK_kauba_mootmed_on_positiivsed CHECK (korgus > 0 AND pikkus > 0 AND laius > 0),<br>
        CONSTRAINT CHK_kauba_pildi_aadress_on_url CHECK (pildi_aadress ~* '^(https?|ftp):\/\/[^\s\/$.?#].[^\s]*$'),<br>
        CONSTRAINT FK_kauba_tootja FOREIGN KEY (tootja) REFERENCES organisatsioon (organisatsiooni_kood) ON DELETE
        Cascade ON UPDATE Cascade,<br>
        CONSTRAINT FK_kauba_kategooria FOREIGN KEY (kauba_kategooria) REFERENCES kauba_kategooria
        (kauba_kategooria_kood) ON DELETE Restrict ON UPDATE Restrict,<br>
        CONSTRAINT FK_kauba_staatus FOREIGN KEY (kauba_staatus) REFERENCES kauba_staatus (kauba_staatuse_kood) ON DELETE
        Restrict ON UPDATE Restrict,<br>
        CONSTRAINT FK_kauba_tarnija FOREIGN KEY (tarnija) REFERENCES organisatsioon (organisatsiooni_kood) ON DELETE
        Cascade ON UPDATE Cascade,<br>
        CONSTRAINT FK_kauba_tootaja FOREIGN KEY (tootaja) REFERENCES tootaja (tootaja_kood) ON DELETE Restrict ON UPDATE
        Restrict<br>
        )<br>
        ;<br><br>
    </div>
    <h2>4.5 Vaated</h2>

    <div>
        CREATE VIEW kauba_kuvatav_info WITH (security_barrier) AS<br>
        SELECT<br>
        kaup.nimetus AS kauba_nimi,<br>
        kaup.hind,<br>
        kaup.korgus,<br>
        kaup.laius,<br>
        kaup.pikkus,<br>
        kategooria.nimetus AS kategooria_nimi,<br>
        tootja.nimi || ', ' || tootja.registri_kood || ', ' || tootja.riik AS tootja,<br>
        tootja.hinne AS tootja_reiting,<br>
        tarnija.nimi AS tarnija,<br>
        tarnija.tarneaeg AS tarnija_tarneaeg<br>
        FROM kaup AS kaup<br>
        INNER JOIN organisatsioon AS tootja ON kaup.tootja = tootja.organisatsiooni_kood<br>
        INNER JOIN kauba_kategooria AS kategooria ON kaup.kauba_kategooria = kategooria.kauba_kategooria_kood<br>
        INNER JOIN organisatsioon AS tarnija ON kaup.tarnija = tarnija.organisatsiooni_kood<br>
        WHERE kaup.kauba_staatus = 1;<br><br>

        COMMENT ON VIEW kauba_kuvatav_info IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõikide aktiivsete kaupade info, mida näidatakse rakenduses kaupade loetelu vormis.';<br><br><br>

        CREATE VIEW ylemkategooria WITH (security_barrier) AS<br>
        SELECT<br>
        kategooria.kauba_kategooria_kood AS kategooria_kood,<br>
        kategooria.nimetus,<br>
        kategooria.kirjeldus<br>
        FROM kauba_kategooria AS kategooria<br>
        WHERE kategooria.ylem_kategooria IS NULL;<br><br>

        COMMENT ON VIEW ylemkategooria IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõik ülemkategooriad ehk kategooriad, millel puudub esivanem.';<br><br><br>

        CREATE VIEW aktiivne_tootaja WITH (security_barrier) AS<br>
        SELECT tootaja.tootaja_kood AS tootaja_kood,<br>
        tootaja.isikukood AS isikukood,<br>
        tootaja.tootaja_rolli_kood AS tootaja_rolli_kood,<br>
        tootaja.tootaja_staatuse_kood AS tootaja_staatuse_kood,<br>
        tootaja.e_mail AS e_mail,<br>
        tootaja.eesnimi AS eesnimi,<br>
        tootaja.perenimi AS perenimi<br>
        FROM tootaja AS tootaja<br>
        WHERE tootaja_staatuse_kood = 1;<br><br>

        COMMENT ON VIEW aktiivne_tootaja IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõik aktiivsed töötajad.';<br><br><br>

        CREATE VIEW kaupade_haldur WITH (security_barrier) AS<br>
        SELECT tootaja.tootaja_kood AS tootaja_kood,<br>
        tootaja.isikukood AS isikukood,<br>
        tootaja.tootaja_rolli_kood AS tootaja_rolli_kood,<br>
        tootaja.tootaja_staatuse_kood AS tootaja_staatuse_kood,<br>
        tootaja.e_mail AS e_mail,<br>
        tootaja.eesnimi AS eesnimi,<br>
        tootaja.perenimi AS perenimi<br>
        FROM tootaja AS tootaja<br>
        WHERE tootaja_rolli_kood = 1;<br><br>

        COMMENT ON VIEW kaupade_haldur IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõik töötajad, kelle rolliks on kaupade haldur.';<br><br><br>

        CREATE VIEW tarnija WITH (security_barrier) AS<br>
        SELECT *<br>
        FROM organisatsioon<br>
        WHERE organisatsiooni_tyybi_kood = 1;<br><br>

        COMMENT ON VIEW tarnija IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõik tarnija-tüüpi organisatsioonid.';<br><br><br>

        CREATE VIEW tootja WITH (security_barrier) AS<br>
        SELECT *<br>
        FROM organisatsioon<br>
        WHERE organisatsiooni_tyybi_kood = 2;<br><br>

        COMMENT ON VIEW tootja IS 'Vaade implementeerib lugemisoperatsiooni, mille käigus tagastatakse kõik tootja-tüüpi organisatsioonid.';<br><br>
    </div>
    <h2>4.6 Protseduursed keeled</h2>

    <div>
        Käesolevas projektis kasutatakse funktsioonide loomiseks PL/pgSQL keelt. PostgreSQL 9.4
        andmebaasisüsteemis installeeritakse PL/pgSQL keel vaikimisi kõikidesse andmebaasidesse
    </div>
    <h2>4.7 Trigeri funktsioonid ja trigerid</h2>

    <div>
        CREATE OR REPLACE FUNCTION kaupa_ei_loodud_aktiivsena()<br>
        RETURNS TRIGGER AS $$<br>
        BEGIN<br>
        RAISE EXCEPTION 'Kauba loomisel saab staatus olla ainult aktiivne!';<br>
        END;<br>
        $$ LANGUAGE plpgsql;<br><br>

        COMMENT ON FUNCTION kaupa_ei_loodud_aktiivsena(*) IS 'Kui kauba staatus pole loomisel aktiivne, siis visatakse
        selle funktsiooniga erand.';<br><br><br>


        CREATE TRIGGER kaup_insert BEFORE INSERT ON kaup<br>
        FOR EACH ROW WHEN (NEW.kauba_staatus != 1) EXECUTE PROCEDURE kaupa_ei_loodud_aktiivsena();<br><br>

        COMMENT ON TRIGGER kaup_insert ON kaup IS 'Kauba loomisel kontrollitakse kas loodav kaup on
        aktiivne';<br><br><br>

        CREATE OR REPLACE FUNCTION kaupa_yritati_kustutada()<br>
        RETURNS TRIGGER AS $$<br>
        BEGIN<br>
        RAISE EXCEPTION 'Kaupa ei saa kustutada! Mitte kunagi! Jäta see meelde!';<br>
        END;<br>
        $$ LANGUAGE plpgsql;<br><br>

        COMMENT ON FUNCTION kaupa_yritati_kustutada(*) IS 'Kauba kustutamisel visatakse selle funktsiooniga erand.';<br><br><br>


        CREATE TRIGGER kaup_delete BEFORE DELETE ON kaup<br>
        FOR EACH ROW EXECUTE PROCEDURE kaupa_yritati_kustutada();<br><br>

        COMMENT ON TRIGGER kaup_delete ON kaup IS 'Kauba kustutamist jälgitakse ning enne seda visatakse
        erand.';<br><br>
    </div>
    <h2> 4.8 Reeglid</h2>

    <div>
        Reegleid käesolevas projektis ei looda.
    </div>
    <h2>4.9 Funktsioonid</h2>

    <div>
        CREATE OR REPLACE FUNCTION uuenda_kaupa(uuendatava_kauba_kood VARCHAR(20), _nimetus VARCHAR(255), _hind
        NUMERIC(19), _pikkus INT, _korgus INT, laius INT, _pildi_aadress VARCHAR(255), _kauba_kategooria INT, _tootja
        INT, _tarnija INT)<br>

        RETURNS VOID AS $$<br><br>

        UPDATE kaup as k<br>
        SET nimetus = _nimetus, hind = _hind, pikkus = _pikkus, korgus = _korgus, pildi_aadress = _pildi_aadress,
        kauba_kategooria = _kauba_kategooria, tootja = _tootja, tarnija = _tarnija WHERE kauba_kood =
        uuendatava_kauba_kood AND kauba_staatus != 0;<br><br>

        $$ LANGUAGE SQL SECURITY DEFINER SET SEARCH_PATH = public, pg_temp;<br><br>

        COMMENT ON FUNCTION uuenda_kaupa(VARCHAR, VARCHAR, NUMERIC, INT, INT, INT, VARCHAR, INT, INT, INT) IS '(OP6.1) Funktsioon uuendab kauba metaandmete paketi, kui kaup pole kustutatud.';<br><br><br>


        CREATE OR REPLACE FUNCTION kustuta_kaup(kauba_kood VARCHAR) <br><br>

        RETURNS void AS $$<br><br>

        UPDATE kaup SET kauba_staatus = 0 WHERE kauba_kood = $1 AND kauba_staatus = 1; <br><br>

        $$ LANGUAGE SQL SECURITY DEFINER<br><br>

        SET search_path = public, pg_temp;<br><br>

        COMMENT ON FUNCTION kustuta_kaup(kauba_kood VARCHAR) IS '(OP7.1) Kauba kustutamisel muutub kauba staatus 0-ks.';<br><br><br>


        CREATE OR REPLACE FUNCTION uuenda_kauba_staatus_aktiivseks(uuendatava_kauba_kood VARCHAR(20))<br><br>

        RETURNS VOID AS $$<br><br>

        UPDATE kaup<br>
        SET kauba_staatus = 1<br>
        WHERE kauba_kood = uuendatava_kauba_kood AND kauba_staatus = 2;<br><br>

        $$ LANGUAGE SQL SECURITY DEFINER SET SEARCH_PATH = public, pg_temp;<br><br>

        COMMENT ON FUNCTION uuenda_kauba_staatus_aktiivseks (VARCHAR) IS '(OP3.1) Seab kauba aktiivseks.';<br><br><br>


        CREATE OR REPLACE FUNCTION uuenda_kauba_staatus_mitteaktiivseks(uuendatava_kauba_kood VARCHAR(20))<br><br>

        RETURNS VOID AS $$<br><br>

        UPDATE kaup<br>
        SET kauba_staatus = 2<br>
        WHERE kauba_kood = uuendatava_kauba_kood AND kauba_staatus = 1;<br><br>

        $$ LANGUAGE SQL SECURITY DEFINER SET SEARCH_PATH = public, pg_temp;<br><br>

        COMMENT ON FUNCTION uuenda_kauba_staatus_mitteaktiivseks (VARCHAR) IS '(OP4.1) Seab kauba mitteaktiivseks.';<br><br>
        
        CREATE OR REPLACE FUNCTION f_on_kaupade_haldur(text, text)<br>
        RETURNS boolean AS $$<br>
        DECLARE<br>
        rslt boolean;<br>
        BEGIN<br>
        SELECT INTO rslt (parool = public.crypt($2, parool))<br>
        FROM tootaja WHERE e_mail=$1 AND tootaja_rolli_kood IN<br>
        (1) AND tootaja_staatuse_kood IN (1);<br>
        RETURN coalesce(rslt, FALSE);<br>
        END;<br>
        $$ LANGUAGE plpgsql SECURITY DEFINER STABLE<br>
        SET search_path = public, pg_temp;<br><br>
        
        COMMENT ON FUNCTION f_on_kaupade_haldur(text, text) IS '(OP1.1) Selle funktsiooni abil autenditakse kaupade haldur. Funktsiooni
        väljakutsel on esimene argument e-mail ja teine argument parool. Kaupade halduril on õigus süsteemi siseneda,
        vaid siis kui tema seisundiks on aktiivne';<br><br>
    </div>
    <h2> 4.10Indeksid</h2>

    <div>
        <h3>4.10.1Välisvõtmetele lisatavad indeksid</h3>

        <div>

            CREATE INDEX IXFK_tootaja_tootaja_roll ON tootaja (tootaja_rolli_kood ASC);<br>

            CREATE INDEX IXFK_tootaja_tootaja_staatus ON tootaja (tootaja_staatuse_kood ASC);<br>

            CREATE INDEX INDEX_tootaja_eesnimi ON tootaja (eesnimi ASC);<br>

            CREATE INDEX INDEX_tootaja_perenimi ON tootaja (perenimi ASC);<br>

            CREATE INDEX IXFK_organisatsioon_organisatsiooni_tyyp ON organisatsioon (organisatsiooni_tyybi_kood
            ASC);<br>

            CREATE INDEX FK_organisatsiooni_riik ON organisatsioon (riik ASC);<br>

            CREATE INDEX FK_kauba_kategooria ON kaup (kauba_kategooria ASC);<br>

            CREATE INDEX FK_kauba_staatus ON kaup (kauba_staatus ASC);<br>

            CREATE INDEX FK_kauba_tarnija ON kaup (tarnija ASC);<br>

            CREATE INDEX FK_kauba_tootaja ON kaup (tootaja ASC);<br>

            CREATE INDEX FK_kauba_tootja ON kaup (tootja ASC);<br>

            CREATE INDEX IXFK_kauba_ylemkategooria ON kauba_kategooria (ylem_kategooria ASC);<br>
        </div>
        <h3>4.10.2 Täiendavad sekundaarsed indeksid </h3>

        <div>
            Täiendavaid sekundaarseid indekseid käesolevas projektis ei looda.
        </div>
        <h3>4.10.3 Funktsioonil põhinevad indeksid </h3>

        <div>
            Funktsioonil põhinevaid indekseid käesolevas projektis ei looda.
        </div>
    </div>
    <h2>4.11 Klassifikaatorite väärtustamise SQL laused </h2>

    <div>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (1, NULL,
        'Arvutikomponendid', 'Erinevad komponendid arvutitele.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (2, 1,
        'Kõvakettad', 'SSD ning HDD kõvakettad.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (3, 1, 'Mälud',
        'Operatiivmälud.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (4, NULL,
        'Telefonid', 'Erinevad nuti- ning mobiiltelefonid.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (5, 4, 'Samsung
        Galaxy 6', 'Samsung Galaxy 6 nutitelefon.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (6, 1,
        'Emaplaadid', 'Valik erinevaid emaplaate.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (7, NULL,
        'Mängukonsoolid', 'Valik erinevaid mängukonsoole.');<br>
        INSERT INTO kauba_kategooria(kauba_kategooria_kood, ylem_kategooria, nimetus, kirjeldus) VALUES (8, 7, 'Sony
        Playstation 4', 'Sony Playstation 4 mängukonsool.');<br><br>

        INSERT INTO kauba_staatus(kauba_staatuse_kood, nimetus, kirjeldus) VALUES (0, 'kustutatud', 'Kaup on kustutatud,
        kuid säilib siiski süsteemis.');<br>
        INSERT INTO kauba_staatus(kauba_staatuse_kood, nimetus, kirjeldus) VALUES (1, 'aktiivne', 'Kaup on
        müügil.');<br>
        INSERT INTO kauba_staatus(kauba_staatuse_kood, nimetus, kirjeldus) VALUES (2, 'mitteaktiivne', 'Kaup ei ole
        müügil.');<br><br>

        INSERT INTO tootaja_roll(tootaja_rolli_kood, nimetus, kirjeldus) VALUES (1, 'kaupade_haldur', 'See annab õiguse
        teha mida iganes.');<br><br>

        INSERT INTO tootaja_staatus(tootaja_staatuse_kood, nimetus, kirjeldus) VALUES (1, 'aktiivne', 'Töötaja on
        tegev.');<br>
        INSERT INTO tootaja_staatus(tootaja_staatuse_kood, nimetus, kirjeldus) VALUES (2, 'mitteaktiivne', 'Töötaja ei
        ole tegev.');<br><br>

        INSERT INTO organisatsiooni_tyyp(organisatsiooni_tyybi_kood, organisatsiooni_tyybi_nimetus) VALUES (1,
        'tarnija');<br>
        INSERT INTO organisatsiooni_tyyp(organisatsiooni_tyybi_kood, organisatsiooni_tyybi_nimetus) VALUES (2,
        'tootja');<br><br>

        INSERT INTO riik(riigi_kood, nimi) VALUES ('EE', 'Eesti');<br>
        INSERT INTO riik(riigi_kood, nimi) VALUES ('RU', 'Venemaa');<br>
        INSERT INTO riik(riigi_kood, nimi) VALUES ('LV', 'Läti');<br>
        INSERT INTO riik(riigi_kood, nimi) VALUES ('LT', 'Leedu');<br>
        INSERT INTO riik(riigi_kood, nimi) VALUES ('FI', 'Soome');<br>
    </div>
    <h2>4.12 Täiendavate testandmete lisamine</h2>

    <div>
        INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (1, 2, 'Akadeemia tee 5, Tallinn 93811, Eesti', 'info@samsung.com',
        'Samsung','110A2746B2C', 5.0, 5.0, 'EE');
        <br>INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (2, 2, 'Hobujaama 3, Tallinn 15334, Eesti', 'info@nokia.com',
        'Nokia','210A2746B3D', 5.0, 5.0, 'EE');
        <br>INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (3, 2, 'Vilde tee 18, Tallinn 13545, Eesti', 'info@dell.com',
        'Dell','310A2746B4E', 5.0, 5.0, 'EE');
        <br>INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (4, 2, 'Müürivahe 33, Tallinn 85773, Eesti', 'info@asus.com',
        'Asus','410A2746B5F', 5.0, 5.0, 'EE');
        <br>INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (5, 2, 'Viru tn 9, Tallinn 34283, Eesti', 'info@intel.com',
        'Intel','510A2746B6G', 5.0, 5.0, 'EE');
        <br>INSERT INTO organisatsioon(organisatsiooni_kood, organisatsiooni_tyybi_kood, aadress, e_mail, nimi,
        registri_kood, tarneaeg, hinne, riik) VALUES (6, 1, 'Kopli liinid, Tallinn 01337, Eesti', 'mart@hot.ee', 'Mardi
        Kiirkuller','43J2HJHJH23', 5.0, 5.0, 'EE');

        <br><br>INSERT INTO tootaja(tootaja_kood, tootaja_rolli_kood, e_mail, eesnimi, isikukood, parool, perenimi)
        VALUES (1, 1, 'hans@mets.ee', 'Hans', '38503053399', public.crypt('parool1', public.gen_salt('bf', 11)),
        'Mets');
        <br>INSERT INTO tootaja(tootaja_kood, tootaja_rolli_kood, e_mail, eesnimi, isikukood, parool, perenimi) VALUES
        (2, 1, 'jaan@koer.ee', 'Jaan', '38404053539', public.crypt('parool2', public.gen_salt('bf', 11)), 'Koer');
        <br>INSERT INTO tootaja(tootaja_kood, tootaja_rolli_kood, e_mail, eesnimi, isikukood, parool, perenimi) VALUES
        (3, 1, 'nele@keel.ee', 'Nele', '49011124567', <br>public.crypt('parool3', public.gen_salt('bf', 11)), 'Keel');
        <br>INSERT INTO tootaja(tootaja_kood, tootaja_rolli_kood, e_mail, eesnimi, isikukood, parool, perenimi) VALUES
        (4, 1, 'ingrid@leht.ee', 'Ingrid', '48503058475', public.crypt('parool4', public.gen_salt('bf', 11)), 'Leht');
        <br>INSERT INTO tootaja(tootaja_kood, tootaja_rolli_kood, e_mail, eesnimi, isikukood, parool, perenimi) VALUES
        (5, 1, 'jaanus@paber.ee', 'Jaanus', '38803084390', public.crypt('parool5', public.gen_salt('bf', 11)), 'Paber');

        <br><br>INSERT INTO kaup(kauba_kood, hind, korgus, laius, nimetus, pikkus, kauba_kategooria, kauba_staatus,
        tootaja, tarnija, tootja) VALUES ('123456789', 15.5, 200, 200, 'DELL 90W AC Adapter', 200, 1, 1, 1, 6, 1);
        <br>INSERT INTO kaup(kauba_kood, hind, korgus, laius, nimetus, pikkus, kauba_kategooria, kauba_staatus, tootaja,
        tarnija, tootja) VALUES ('987654321', 20.5, 250, 250, 'Playstation 4', 250, 7, 1, 1, 6, 2);
        <br>INSERT INTO kaup(kauba_kood, hind, korgus, laius, nimetus, pikkus, kauba_kategooria, kauba_staatus, tootaja,
        tarnija, tootja) VALUES ('483659682', 25.5, 100, 50, 'iPhone 6', 10, 4, 1, 1, 6, 3);
        <br>INSERT INTO kaup(kauba_kood, hind, korgus, laius, nimetus, pikkus, kauba_kategooria, kauba_staatus, tootaja,
        tarnija, tootja) VALUES ('759384627', 35.5, 220, 200, 'Samsung 3.5 D3 Station 5TB', 200, 1, 1, 1, 6, 4);
        <br>INSERT INTO kaup(kauba_kood, hind, korgus, laius, nimetus, pikkus, kauba_kategooria, kauba_staatus, tootaja,
        tarnija, tootja) VALUES ('649027384', 45.5, 100, 50, 'Samsung Galaxy S6', 10, 4, 1, 1, 6, 5);<br>
    </div>
    <h2>4.13 Andmebaasi statistika kogumine </h2>

    <div>
        VACUUM ANALYZE;<br><br>
        PostgreSQLis jäävad kustutatud ridade või muutmise tulemusena üleliigseks muutunud ridade
        andmed andmebaasi sisemisele tasemele alles. Nende lõplikuks kustutamiseks sisemiselt tasemelt
        tuleb käivitada prügikoristus – VACUUM lause. ANALYZE määrang lauses tagab, et lisaks
        prügikoristusele värskendatakse ka andmebaasi statistikat. Tabeliga saab siduda ka korralduse
        käivitada prügikoristus ning statistika kogumine automaatselt (autovacuum), kui tabelisse lisatud,
        muudetud või kustutatud ridade arv ületab ettemääratud lävendi. Käesolevas projektis seda
        võimalust ei kasutata. Käesolevas jaotises toodud lauset tuleks käivitada vähemalt kord päevas,
        soovitavalt siis, kui andmebaasi kasutamise koormus on madal (näiteks öösel).<br>
    </div>
    <h2>4.14 Päringu täitmisplaani näide</h2>

    <div>
         Analüüsin päringut, mis on tehtud vaate kauba_kuvatav_info põhjal. <br><br>
                    CREATE VIEW kauba_kuvatav_info AS<br>
                    SELECT<br>
                    kaup.nimetus AS kauba_nimi,<br>
                    kaup.hind,<br>
                    kaup.korgus,<br>
                    kaup.laius,<br>
                    kaup.pikkus,<br>
                    kategooria.nimetus AS kategooria_nimi,<br>
                    tootja.nimi || ', ' || tootja.registri_kood || ', ' || tootja.riik AS tootja,<br>
                    tootja.hinne AS tootja_reiting,<br>
                    tarnija.nimi AS tarnija,<br>
                    tarnija.tarneaeg AS tarnija_tarneaeg<br>
                    FROM kaup AS kaup<br>
                    INNER JOIN organisatsioon AS tootja ON kaup.tootja = tootja.organisatsiooni_kood<br>
                    INNER JOIN kauba_kategooria AS kategooria ON kaup.kauba_kategooria = kategooria.kauba_kategooria_kood<br>
                    INNER JOIN organisatsioon AS tarnija ON kaup.tarnija = tarnija.organisatsiooni_kood<br>
                    WHERE kaup.kauba_staatus = 1;<br><br>

                    ANALYZE<br>
                    EXPLAIN SELECT * FROM kauba_kuvatav_info;<br><br>
                  <table class="query plan">
                    <tr>
                        <th><div>QUERY PLAN</div></th>
                    </tr>
                    <tr>
                        <td><div>1&nbsp; Hash Join  (cost=22.38..34.60 rows=5 width=1661)</div></td>
                    </tr>
                    <tr>
                        <td><div>2&nbsp;  Hash Cond: (kategooria.kauba_kategooria_kood = kaup.kauba_kategooria)</div></td>
                    </tr>
                    <tr>
                        <td><div>3&nbsp;  -&gt;&nbsp;  Seq Scan on kauba_kategooria kategooria  (cost=0.00..11.30 rows=130 width=36)</div></td>
                    </tr>
                    <tr>
                        <td><div>4&nbsp;  -&gt;&nbsp;  Hash  (cost=22.31..22.31 rows=5 width=1633)</div></td>
                    </tr>
                    <tr>
                        <td><div>5&nbsp;        -&gt;&nbsp;  Hash Join  (cost=11.70..22.31 rows=5 width=1633)</div></td>
                    </tr>
                    <tr>
                        <td><div>6&nbsp;              Hash Cond: (tarnija.organisatsiooni_kood = kaup.tarnija)</div></td>
                    </tr>
                    <tr>
                        <td><div>7&nbsp;              -&gt;&nbsp;  Seq Scan on organisatsioon tarnija  (cost=0.00..10.30 rows=30 width=532)</div></td>
                    </tr>
                    <tr>
                        <td><div>8&nbsp;              -&gt;&nbsp;  Hash  (cost=11.64..11.64 rows=5 width=1109)</div></td>
                    </tr>
                    <tr>
                        <td><div>9&nbsp;                    -&gt;&nbsp;  Hash Join  (cost=1.14..11.64 rows=5 width=1109)</div></td>
                    </tr>
                    <tr>
                        <td><div>10&nbsp;                          Hash Cond: (tootja.organisatsiooni_kood = kaup.tootja)</div></td>
                    </tr>
                    <tr>
                        <td><div>11&nbsp;                          -&gt;&nbsp;  Seq Scan on organisatsioon tootja  (cost=0.00..10.30 rows=30 width=1060)</div></td>
                    </tr>
                    <tr>
                        <td><div>12&nbsp;                          -&gt;&nbsp;  Hash  (cost=1.07..1.07 rows=5 width=57)</div></td>
                    </tr>
                    <tr>
                        <td><div>13&nbsp;                                -&gt;&nbsp;  Seq Scan on kaup  (cost=0.00..1.07 rows=5 width=57)</div></td>
                    </tr>
                    <tr>
                        <td><div>14&nbsp;                                      Filter: (kauba_staatus = 1)</div></td>
                    </tr>
                </table>
                <br>14 row(s)<br><br>

                Enne täitmisplaani koostamist värskendasin ANALYZE lause abil andmebaasi statistikat, et
                andmebaasisüsteemil oleks täitmisplaani koostamiseks võimalikult täpne sisendinformatsioon.
                Täitmisplaani tuleb lugeda alt üles ja seest välja (paremalt vasakule). Allpool/seespool esitatud
                operatsiooni tulemus on sisendiks ülalpool/väljaspool esitatud operatsioonile. Täitmisplaani
                koostamise ajal olid tabelid peaaegu tühjad ja see võib mõjutada plaani valikut (näiteks antud juhul
                eelistatakse tabeli täielikku läbiskaneerimist indeksi kasutamisele). Kuna EXPLAIN lauses ei
                kasutatud ANALYZE määrangut, siis uuritavat lauset tegelikult ei täidetud ning seega pole näha
                terve lause ning selle täitmiseks vajalike üksikute operatsioonide tegelikke täitmisaegu ning samuti
                plaani koostamiseks kulunud aega. <br><br>

                1-4 -Tabelid Kategooria ja Kaup ühendatakse  kasutades hash join algoritmi.  Ühendamise tulemusena loodud tabel, kui oodatavalt väiksem 
                tabel, valiti sisemiseks tabeliks. Ühendamise tulemusena leitud tabelist loetud Kauba_kategooria_kood
                väärtuste alusel leitakse räsiväärtused ja moodustatakse mällu ajutine räsitabel. Räsitabelis
                olevaid väärtuseid hakatakse võrdlema tabelist Kauba_kategooria loetud väärtustega. Selle ühendamise
                kontekstis on Kauba_kategooria väline tabel. Kauba_kategooria_kood väärtused tabelist Kauba_kategooria leitakse tabelite täielikku
                läbiskaneerimist kasutades. <br><br>

                5-8 - Tabelid Tarbija ja Kaup ühendatakse  kasutades hash join algoritmi.  Ühendamise tulemusena loodud tabel, kui oodatavalt väiksem 
                tabel, valiti sisemiseks tabeliks. Ühendamise tulemusena leitud tabelist loetud Organisatsiooni_kood
                väärtuste alusel leitakse räsiväärtused ja moodustatakse mällu ajutine räsitabel. Räsitabelis
                olevaid väärtuseid hakatakse võrdlema tabelist Tarnija loetud väärtustega. Selle ühendamise
                kontekstis on Tarnija väline tabel. Organisatsiooni_kood väärtused tabelist Tarnija leitakse tabelite täielikku
                läbiskaneerimist kasutades. <br><br>

                9-12 - Tabelid Tootja ja Kaup ühendatakse  kasutades hash join algoritmi.  Ühendamise tulemusena loodud tabel, kui oodatavalt väiksem 
                tabel, valiti sisemiseks tabeliks. Ühendamise tulemusena leitud tabelist loetud Organisatsiooni_kood
                väärtuste alusel leitakse räsiväärtused ja moodustatakse mällu ajutine räsitabel. Räsitabelis
                olevaid väärtuseid hakatakse võrdlema tabelist Tootja loetud väärtustega. Selle ühendamise
                kontekstis on Tootja väline tabel. Organisatsiooni_kood väärtused tabelist Tootja leitakse tabelite täielikku
                läbiskaneerimist kasutades. <br><br>

                13-14 - Tabeli Kaup läbiskaneerimisel leitakse vaid read, mis rahuldavad tingimust
                (kauba_staatus = 1) - kaup on aktiivne. <br>
                
    </div>
    <h2>4.15 Rollid ja kasutajad</h2>

    <div>
        Käesolevas töös rolle ei looda. Luuakse rakendusele vastav kasutaja. <br>

        CREATE USER garaazh_rakendus WITH PASSWORD 'garaga';
    </div>
    <h2>4.16 Õiguste jagamine </h2>

    <div>
        <pre>
DROP USER IF EXISTS garaazh_rakendus;
CREATE USER garaazh_rakendus WITH PASSWORD 'garaga';

REVOKE CONNECT, TEMP ON DATABASE t123665 FROM PUBLIC; 
REVOKE CREATE, USAGE ON SCHEMA public FROM PUBLIC;
REVOKE USAGE ON LANGUAGE plpgsql FROM PUBLIC;

REVOKE EXECUTE ON FUNCTION
f_uuenda_kaupa(uuendatava_kauba_kood VARCHAR(20), _nimetus VARCHAR(255), 
_hind NUMERIC(19), _pikkus INT, _korgus INT, _laius INT, 
_pildi_aadress VARCHAR(255), _kauba_kategooria INT, _tootja INT, _tarnija INT),
f_kustuta_kaup(kauba_kood VARCHAR),
f_uuenda_kauba_staatus_aktiivseks(uuendatava_kauba_kood VARCHAR(20)),
f_uuenda_kauba_staatus_mitteaktiivseks(uuendatava_kauba_kood VARCHAR(20)) FROM PUBLIC;

GRANT CONNECT ON DATABASE t123665 TO garaazh_rakendus; 
GRANT USAGE ON SCHEMA public TO garaazh_rakendus;

GRANT SELECT, UPDATE ON TABLE kaup TO garaazh_rakendus;
GRANT SELECT ON TABLE kauba_kategooria TO garaazh_rakendus;
GRANT SELECT ON TABLE tootja TO garaazh_rakendus;
GRANT SELECT ON TABLE tarnija TO garaazh_rakendus;
GRANT SELECT ON TABLE tootaja TO garaazh_rakendus;

GRANT EXECUTE ON FUNCTION
f_on_kaupade_haldur(text, text),
f_uuenda_kaupa(uuendatava_kauba_kood VARCHAR(20), _nimetus VARCHAR(255), 
_hind NUMERIC(19), _pikkus INT, _korgus INT, _laius INT, 
_pildi_aadress VARCHAR(255), _kauba_kategooria INT, _tootja INT, _tarnija INT),
f_kustuta_kaup(kauba_kood VARCHAR),
f_uuenda_kauba_staatus_aktiivseks(uuendatava_kauba_kood VARCHAR(20)),
f_uuenda_kauba_staatus_mitteaktiivseks(uuendatava_kauba_kood VARCHAR(20))
TO garaazh_rakendus;
        </pre>
    </div>
    <h2>4.17 Andmebaasiobjektide kustutamine </h2>

    <div>
        <h3>4.17.1Domeenide kustutamine</h3>

        <div>
            DROP DOMAIN IF EXISTS d_nimetus;
        </div>
        <h3>4.17.2Tabelite kustutamine</h3>

        <div>
            DROP TABLE IF EXISTS tootaja_staatus CASCADE;<br>

            DROP TABLE IF EXISTS tootaja_roll CASCADE;<br>

            DROP TABLE IF EXISTS tootaja CASCADE;<br>

            DROP TABLE IF EXISTS riik CASCADE;<br>

            DROP TABLE IF EXISTS organisatsiooni_tyyp CASCADE;<br>

            DROP TABLE IF EXISTS organisatsioon CASCADE;<br>

            DROP TABLE IF EXISTS kaup CASCADE;<br>

            DROP TABLE IF EXISTS kauba_staatus CASCADE;<br>

            DROP TABLE IF EXISTS kauba_kategooria CASCADE;<br>
        </div>
        <h3>4.17.3Arvujada generaatorite kustutamine</h3>

        <div>
            Kuna arvujada generaatorid loodi SERIAL tüübi kasutamise abil, siis kustutas andmebaasisüsteem
            tabelite kustutamisel automaatselt nendega seotud arvujada generaatorid.
        </div>
        <h3>4.17.4 Vaadete kustutamine </h3>

        <div>

            DROP VIEW IF EXISTS kauba_kuvatav_info;<br>
            DROP VIEW IF EXISTS ylemkategooria; <br>
            DROP VIEW IF EXISTS aktiivne_tootaja;<br>
            DROP VIEW IF EXISTS kaupade_haldur;<br>
            DROP VIEW IF EXISTS tarnija;<br>
            DROP VIEW IF EXISTS tootja;<br><br>
        </div>
        <h3>4.17.5 Indeksite kustutamine </h3>

        <div>
            DROP INDEX IF EXISTS IXFK_tootaja_tootaja_roll;<br>

            DROP INDEX IF EXISTS IXFK_tootaja_tootaja_staatus;<br>

            DROP INDEX IF EXISTS INDEX_tootaja_eesnimi;<br>

            DROP INDEX IF EXISTS INDEX_tootaja_perenimi;<br>

            DROP INDEX IF EXISTS IXFK_organisatsioon_organisatsiooni_tyyp;<br>

            DROP INDEX IF EXISTS FK_organisatsiooni_riik;<br>

            DROP INDEX IF EXISTS FK_kauba_kategooria;<br>

            DROP INDEX IF EXISTS FK_kauba_staatus;<br>

            DROP INDEX IF EXISTS FK_kauba_tarnija;<br>

            DROP INDEX IF EXISTS FK_kauba_tootaja;<br>

            DROP INDEX IF EXISTS FK_kauba_tootja;<br>

            DROP INDEX IF EXISTS IXFK_kauba_ylemkategooria;<br>
        </div>
        <h3>4.17.6 Funktsioonide ja trigerite kustutamine</h3>

        <div>
            DROP TRIGGER kaup_insert ON kaup;<br>
            DROP TRIGGER kaup_delete ON kaup;<br><br>

            DROP FUNCTION uuenda_kaupa(uuendatava_kauba_kood VARCHAR(20), _nimetus VARCHAR(255), _hind NUMERIC(19),
            _pikkus INT, _korgus INT, laius INT, _pildi_aadress VARCHAR(255), _kauba_kategooria INT, _tootja INT,
            _tarnija INT);<br>
            DROP FUNCTION kustuta_kaup(kauba_kood VARCHAR);<br>
            DROP FUNCTION uuenda_kauba_staatus_aktiivseks(uuendatava_kauba_kood VARCHAR(20));<br>
            DROP FUNCTION uuenda_kauba_staatus_mitteaktiivseks(uuendatava_kauba_kood VARCHAR(20));<br><br>
        </div>
        <h3>4.17.7 Reeglite kustutamine</h3>

        <div>
            Kuna projektis reegleid ei kasutata, siis ei esitata ka reeglite kustutamise lauseid.
        </div>
        <h3>4.17.8 Kasutajate ja rollide kustutamine</h3>

        <div>
            Kuna projektis rolle ei kasutata, siis ei esitata ka rollide kustutamise lauseid.
            Enne kasutaja kustutamist tuleb ära võtta sellele antud õigused.
            <b> REVOKE laused tegemata !!!</b>
        </div>
    </div>
</div>
<h1>5 Kasutatud materjalid</h1>

<p> 1. Ehitusseadus. Elektrooniline Riigi Teataja. [WWW]
    https://www.riigiteataja.ee/akt/728982?leiaKehtiv (08.02.2015)
</p>

<p>
    2. Ülikooli infosüsteemi vastuvõtuaegade allsüsteem 2015 [WWW]
    http://maurus.ttu.ee/ained/IDU0230_2015/doc/2/Naidisprojekt_IDU0230_vastuvotuajad_ver4_6.pdf (19.12.2015)
</p>

<p>
    3. ESTERM [WWW] http://mt.legaltext.ee/esterm/ (26.04.2015)
</p>

<p>
    4. Chisholm, M. (2000). Managing Reference Data in Enterprise Databases:
    Binding Corporate Data to the Wider World. Morgan Kaufmann.
</p>

<p>5. Isikukoodide moodustamise, väljajagamise ja andmise kord. Elektrooniline Riigi Teataja. [WWW]
    https://www.riigiteataja.ee/akt/838530</p>
</body>

</html>
